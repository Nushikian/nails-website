(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[305],{"/WHw":function(e,t,i){i.d(t,"a",(function(){return f}));var n=i("q1tI"),o=i("/MKj"),a=i("JW66"),s=i("Ye/N"),r=i("5FNA"),c=i("Wer7"),d=i("vvax"),l=i("ANjH"),h=i("oN2T"),u=i("c50B"),b=i("nKUr");function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e){var t,i;return i=t=class extends n.Component{constructor(...e){super(...e),p(this,"state",{createBoardError:null,inputName:this.props.prefilledName||"",nameValidators:[Object(u.o)({message:s.a._("Don't forget to name your board!")}),Object(u.j)({max:a.a.MAX_CHARS_FOR_BOARD_TITLE,maxErrorString:Object(d.b)(s.a._("Please enter no more than {{ maxLength }} characters.","Validation error when a user input is too long","Validation error when a user input is too long"),{maxLength:a.a.MAX_CHARS_FOR_BOARD_TITLE}).join("")})],nameValidatorErrors:[],privacy:this.props.isAdAccountOwner?a.a.BoardPrivacy.PUBLIC:a.a.BoardPrivacy.PROTECTED,saving:!1}),p(this,"invalidateResource",e=>{const{dispatch:t,viewer:i}=this.props;t(Object(c.f)("BoardsResource",Object(r.a)(i.isAuth?i.username:"",e===a.a.BoardPrivacy.SECRET)))}),p(this,"createBoard",e=>{const{dispatch:t,viewer:i}=this.props;return t(Object(h.g)(e,{isFBC:i.isAuth&&0===i.boardCount}))}),p(this,"handleChangeName",(e,t)=>{const i=Object(u.r)(this.state.nameValidators,e);this.setState({inputName:e,nameValidatorErrors:i,createBoardError:null},()=>{t&&this.handleCreate()})}),p(this,"handleChangePrivacy",()=>{const e=this.state.privacy===a.a.BoardPrivacy.SECRET?a.a.BoardPrivacy.PUBLIC:a.a.BoardPrivacy.SECRET;this.setState({privacy:e})}),p(this,"handleCreate",()=>{const{inputName:e,privacy:t}=this.state,{isAdAccountOwner:i,onCreate:n,advertiser_id:o}=this.props,a={privacy:t,name:e,...!i&&o?{advertiser_id:o}:{}};this.setState({saving:!0,createBoardError:null}),this.createBoard(a).then(e=>{this.setState({saving:!1}),n(e)}).catch(e=>{let t=s.a._("Uh oh! Something went wrong.");if("string"==typeof e)t=e;else if(e.message){const{message:i,message_detail:n}=e;t=n?`${i} ${n}`:i}this.setState({saving:!1,createBoardError:t})}),this.invalidateResource(t)})}render(){return Object(b.jsx)(e,{onBoardCreate:this.handleCreate,onChangeBoardName:this.handleChangeName,onChangeBoardPrivacy:this.handleChangePrivacy,...this.props,...this.state})}},p(t,"displayName",`WithBoardCreatePane(${e.displayName||e.name})`),i}function j({advertiser:e,viewer:t}){const i=!e||t.isAuth&&e.owner_user_id===t.id,n=e&&e.id;return{isAdAccountOwner:i,...n?{advertiser_id:n}:{},viewer:t}}function g(e){return{dispatch:e}}function f(e){return Object(l.compose)(Object(o.connect)(j,g),m)(e)}},"5FNA":function(e,t,i){i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d}));var n=i("qtKf"),o=i("Pqnw"),a=i("Wer7");const s=["alphabetical","last_pinned_to","oldest","newest","group_boards_at_top","custom"],r={name:"BoardsResource",key:"boardsResource",options:({boardOrder:e,filterStories:t,mixPublicSecret:i,username:n})=>({privacy_filter:"all",sort:e||"last_pinned_to",field_set_key:"profile_grid_item",filter_stories:t,username:n,page_size:25,group_by:i?"mix_public_private":"visibility",include_archived:!0,redux_normalize_feed:!0})},c=(e,t,i)=>({privacy_filter:t?"secret":"public",sort:i||"last_pinned_to",field_set_key:"profile_grid_item",username:e}),d=e=>s.reduce((t,i)=>{const s=[Object(o.a)("profileBoards",Object(n.c)(e,i))];return[!0,!1].forEach(t=>{[!0,!1].forEach(n=>{s.push(Object(a.f)(r.name,r.options({username:e,boardOrder:i,mixPublicSecret:t,filterStories:n})))})}),t.concat(s)},[])},"6A0I":function(e,t,i){var n=i("q1tI"),o=i("/MKj"),a=i("JW66"),s=i("Sihc"),r=i("Ye/N"),c=i("GBVV"),d=i("n6mq"),l=i("nKUr");function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class u extends n.Component{constructor(e){super(e),h(this,"onCreateSection",()=>{const{board:e,dispatch:t,completeCreateSectionAction:i,pinImport:n}=this.props;return this.setState({isSaving:!0}),t(Object(s.a)({boardId:e.id,name:this.state.inputName.trim(),pinImport:n})).then(e=>{this.setState({isSaving:!1}),i(e)}).catch(e=>{this.setState({createError:e.message_detail||e.message,isSaving:!1})})}),h(this,"handleKeyDown",({event:e,value:t})=>{const{createError:i,inputName:n}=this.state;[a.a.KeyCode.ENTER,a.a.KeyCode.NUMPAD_ENTER].includes(e.which)&&!i&&n.trim()&&this.onCreateSection()}),h(this,"handleChangeName",({value:e})=>{this.setState({createError:null,inputName:e})}),h(this,"handleInputRef",e=>{this.setState({inputRef:e})}),this.state={createError:null,inputName:e.initialName||"",inputRef:null,isSaving:!1}}componentDidUpdate(e,t){const{createError:i,inputRef:n}=this.state;!n||t.inputRef&&!i||n.focus()}render(){const{showTitle:e,positionRelative:t}=this.props,{createError:i,inputName:n,isSaving:o}=this.state,a=!!n.trim()&&!i;return Object(l.jsxs)(d.f,{display:"flex",direction:"column",color:"white",flex:"grow",top:!0,bottom:!0,right:!0,position:t?"relative":"absolute",rounding:2,width:"100%",dangerouslySetInlineStyle:{__style:{borderLeft:"1px solid #f5f5f5"}},children:[e&&Object(l.jsx)(d.f,{marginTop:3,paddingX:6,paddingY:3,children:Object(l.jsx)(d.u,{size:"sm",children:r.a._("Add section","Title in the add section modal","Title in the add section modal")})}),Object(l.jsxs)(d.f,{padding:4,children:[Object(l.jsx)(d.f,{marginBottom:2,children:Object(l.jsx)(d.y,{htmlFor:"sectionEditName",children:Object(l.jsx)(d.ab,{size:"md",color:i?"red":"gray",children:r.a._("Name","Board section name","Board section name")})})}),Object(l.jsx)(d.f,{children:Object(l.jsx)(d.f,{ref:this.handleInputRef,children:Object(l.jsx)(d.cb,{errorMessage:i||"",id:"sectionEditName",name:"sectionName",onChange:this.handleChangeName,onKeyDown:this.handleKeyDown,placeholder:r.a._('Like "Lighting"',"Placeholder for board section name","Placeholder for board section name"),size:"lg",type:"text",value:n})})})]}),Object(l.jsx)(d.f,{display:"flex",flex:"grow"}),Object(l.jsx)(d.f,{padding:4,children:Object(l.jsx)(d.f,{display:"flex",justifyContent:"end",children:Object(l.jsx)(c.b,{disabled:!a||o,onClick:this.onCreateSection,submitting:o,text:r.a._("Add","add a new section","add a new section")})})})]})}}t.a=Object(o.connect)()(u)},"6G9P":function(e,t,i){i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return d}));var n=i("q1tI"),o=(i("JW66"),i("yaUg")),a=i("Ye/N"),s=i("n6mq"),r=i("nKUr");const c=(e,t)=>{if(!t)return e;const i=new RegExp(/http(s?):/);if(!i.test(e)){const n=i.exec(t);if(n&&n.length){e=n[0]+e}}return e},d=(e,t)=>t?Object(o.a)(a.a._("Saved to {{sectionName}} in {{boardName}}","Toast for successfully saving to a section within a board","Toast for successfully saving to a section within a board"),{sectionName:t.title,boardName:null!=e?e:""}):Object(r.jsxs)(n.Fragment,{children:[Object(r.jsx)(s.ab,{children:a.a._("Saved to")}),Object(r.jsx)(s.ab,{weight:"bold",children:e})]})},B6Tf:function(e,t,i){i.d(t,"a",(function(){return pe})),i.d(t,"b",(function(){return me}));var n=i("q1tI"),o=i("b/K5"),a=i("/MKj"),s=i("JW66"),r=i("Ye/N"),c=i("GBVV"),d=i("/WHw"),l=i("pLLR"),h=i("fZbY"),u=i("oRM1"),b=i("FDmi"),p=i("yaUg"),m=i("n6mq"),j=i("nKUr");function g(e){const{body:t,img:i,onClick:n,selected:o,title:a,username:s,valid:c}=e,d=s||t;return Object(j.jsx)(m.f,{marginBottom:4,children:Object(j.jsx)(m.Z,{onTap:n,children:Object(j.jsxs)(m.f,{alignItems:"center",direction:"row",display:"flex",width:"100%",children:[i,Object(j.jsxs)(m.f,{flex:"grow",marginEnd:2,marginStart:3,children:[Object(j.jsx)(m.f,{marginBottom:1,children:Object(j.jsx)(m.ab,{truncate:!0,weight:"bold",children:a})}),Object(j.jsx)(m.ab,{size:"sm",truncate:!0,children:d})]}),Object(j.jsx)(m.f,{marginStart:2,children:(l=o,h=c,s?l?Object(j.jsx)(m.v,{accessibilityLabel:r.a._("Confirmation an invite will be sent","Alt tags on a check box on the board create flow for board invites","Alt tags on a check box on the board create flow for board invites"),color:"red",icon:"check-circle",size:32}):Object(j.jsx)(m.f,{dangerouslySetInlineStyle:{__style:{border:"solid 1px #B5B5B5"}},height:32,rounding:"circle",width:32}):Object(j.jsx)(m.g,{color:"gray",disabled:!!l||Boolean(!h),inline:!0,size:"sm",text:l?r.a._("Sent","Sent a board collaborator invite","Sent a board collaborator invite"):r.a._("Invite","Add board collaborator invite","Add board collaborator invite")}))})]})})});var l,h}var f=i("ZE2w"),x=i("w70y");function O(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t,i){const{id:n}=e;return t===i.findIndex(e=>e.id===n)}class v extends n.Component{constructor(...e){super(...e),O(this,"state",{selectedCollaborators:this.props.preselectedCollaborators||[],typeaheadSuggestions:[],value:""}),O(this,"isIdSelected",{}),O(this,"handleTextFieldChange",({value:e})=>{this.setState({value:e})}),O(this,"handleCollaboratorClick",e=>{const{id:t,type:i}=e;this.isIdSelected[t]=!this.isIdSelected[t];const{selectedCollaborators:n}=this.state,o=n.concat([e]),a="email"===i?f.c:f.d;this.props.onSelectedCollaboratorsChange({id:t,resource:a}),this.setState({selectedCollaborators:o})}),O(this,"handleTypeaheadSuggestionsChange",e=>{this.setState({typeaheadSuggestions:e})})}componentDidMount(){this.props.preselectedCollaborators&&this.props.preselectedCollaborators.map(e=>{const{id:t,type:i}=e;this.isIdSelected[t]=!this.isIdSelected[t];const n="email"===i?f.c:f.d;return this.props.onSelectedCollaboratorsChange({id:t,resource:n}),null})}render(){const{value:e}=this.state,{shareSuggestionsResource:{data:t}}=this.props,i=t||[],n=(""===e?this.state.selectedCollaborators.concat(i).filter(y):this.state.selectedCollaborators.concat(this.state.typeaheadSuggestions).concat({type:"email",id:e,valid:Object(h.a)(e)}).concat(i).filter(y)).map(e=>function(e,t,i){if("user_share_suggestion"===e.type||"user"===e.type){const n=Object(j.jsx)(b.a,{name:e.title||e.full_name,size:"sm",src:e.image_medium_url||e.image_large_url});return Object(j.jsx)(g,{img:n,onClick:()=>i(e),selected:t,title:e.full_name,username:e.username})}if("email"===e.type){const{id:n,valid:o}=e,a=Object(j.jsx)(m.f,{alignItems:"center",color:"lightGray",display:"flex",height:40,justifyContent:"center",rounding:"circle",width:40,children:Object(j.jsx)(m.v,{accessibilityLabel:r.a._("Email icon","Email icon on board create modal","Email icon on board create modal"),color:"darkGray",icon:"envelope",size:20})}),s=Object(p.a)(r.a._("Email {{ email }}"),{email:n});let c,d;return t?(c=r.a._("Done!","Text that lets the user know we sent the board invite email","Text that lets the user know we sent the board invite email"),d=()=>{}):(c=o?r.a._("Click to send!","Text that lets the user know they can successfully send a board invite email","Text that lets the user know they can successfully send a board invite email"):r.a._("Keep typing!","Text that lets a user know the email they are typing is not valid yet","Text that lets a user know the email they are typing is not valid yet"),d=()=>o?i(e):void 0),Object(j.jsx)(g,{body:c,img:a,onClick:d,selected:t,title:s,valid:o})}}(e,this.isIdSelected[e.id],this.handleCollaboratorClick)).map((e,t)=>Object(j.jsx)("li",{children:e},t));return Object(j.jsxs)(m.f,{direction:"column",display:"flex",height:"100%",children:[Object(j.jsx)(m.f,{paddingX:3,paddingY:2,children:Object(j.jsx)(m.ab,{size:"sm",children:r.a._("Add collaborators (optional)","Optional field to add collaborators to a board on board create","Optional field to add collaborators to a board on board create")})}),Object(j.jsx)(m.f,{marginBottom:4,marginTop:2,paddingX:3,width:"100%",children:Object(j.jsx)(m.f,{flex:"grow",children:Object(j.jsx)(u.a,{onTypeaheadSuggestionsChange:this.handleTypeaheadSuggestionsChange,resourceName:"ShareSuggestionsTypeaheadResource",value:e,children:Object(j.jsx)(m.P,{accessibilityLabel:r.a._("Search for collaborators by name or email"),id:"CollaboratorInviteSearchField",onChange:this.handleTextFieldChange,placeholder:r.a._("Search by name or email"),size:"lg",value:e})})})}),Object(j.jsx)(m.f,{overflow:"scrollY",paddingX:3,children:Object(j.jsx)("ul",{children:n})})]})}}var _=Object(x.b)({name:"ShareSuggestionsResource",key:"shareSuggestionsResource",allowStale:!1})(v);var S=Object(d.a)((function({createBoardError:e,inputName:t,nameValidatorErrors:i,onBoardCreate:o,onCancel:a,onChangeBoardName:d,onChangeBoardPrivacy:h,onInvite:u,privacy:b,preselectedCollaborators:p,saving:g,showTitle:f,isAdAccountOwner:x}){const{isRTL:O}=Object(l.d)(),y=0===i.length,v=b===s.a.BoardPrivacy.SECRET;return Object(j.jsx)(m.f,{color:"white",height:"100%",left:!0,position:"absolute",top:!0,width:"100%",children:Object(j.jsx)("form",{onSubmit:e=>{e.preventDefault(),o()},style:{height:"100%"},children:Object(j.jsxs)(m.f,{direction:"column",display:"flex",height:"100%",children:[f&&Object(j.jsx)(m.f,{display:"flex",marginTop:3,paddingX:6,paddingY:3,children:Object(j.jsx)(m.u,{size:"sm",children:r.a._("Create board")})}),Object(j.jsxs)(m.f,{padding:3,children:[Object(j.jsx)(m.f,{marginBottom:2,children:Object(j.jsx)(m.y,{htmlFor:"boardEditName",children:Object(j.jsx)(m.ab,{size:"sm",children:r.a._("Name")})})}),Object(j.jsx)(m.f,{children:Object(j.jsx)(m.cb,{errorMessage:i.join(", "),id:"boardEditName",name:"boardName",onChange:({value:e})=>d(e),placeholder:r.a._('Like "Places to Go" or "Recipes to Make"'),size:"lg",value:t})})]}),x&&Object(j.jsxs)(n.Fragment,{children:[Object(j.jsxs)(m.f,{padding:3,children:[Object(j.jsx)(m.f,{marginBottom:2,children:Object(j.jsx)(m.y,{htmlFor:"secret",children:Object(j.jsx)(m.ab,{size:"sm",children:r.a._("Secret","secret board","secret board")})})}),Object(j.jsx)(m.f,{children:Object(j.jsx)(m.V,{id:"secret",onChange:h,switched:v})})]}),Object(j.jsx)(m.f,{display:"flex",flex:"grow",overflow:"hidden",children:Object(j.jsx)(m.f,{width:"100%",children:Object(j.jsx)(_,{onSelectedCollaboratorsChange:u,preselectedCollaborators:p})})})]}),!x&&Object(j.jsx)(n.Fragment,{children:Object(j.jsxs)(m.f,{padding:3,children:[Object(j.jsx)(m.f,{marginBottom:2,children:Object(j.jsx)(m.y,{htmlFor:"protected",children:Object(j.jsx)(m.ab,{size:"sm",children:r.a._("Protected board (not listed on user's profile)","protected board","protected board")})})}),Object(j.jsx)(m.f,{children:Object(j.jsx)(m.V,{disabled:!0,id:"protected",onChange:()=>{},switched:!0})})]})}),Object(j.jsxs)(m.f,{bottom:!0,color:"white",dangerouslySetInlineStyle:{__style:{boxShadow:"0px 0px 8px rgba(0, 0, 0, 0.1)",borderBottomLeftRadius:"32px",borderBottomRightRadius:"32px"}},display:"flex",justifyContent:"between",left:O,paddingX:4,paddingY:2,position:"absolute",right:!O,width:720,children:[Object(j.jsx)(m.g,{inline:!0,onClick:a,text:r.a._("Cancel","cancel board create","cancel board create")}),Object(j.jsxs)(m.f,{display:"flex",justifyContent:"end",children:[!!e&&Object(j.jsx)(m.f,{paddingX:2,children:Object(j.jsx)(m.ab,{align:"center",color:"red",size:"md",weight:"bold",children:e})}),Object(j.jsx)(c.b,{disabled:!t.trim()||!y||!!e||g,submitting:g,text:r.a._("Create","create a new board","create a new board")})]})]})]})})})})),w=i("6A0I"),C=i("qyR9"),T=i("0BOE");class I extends n.Component{constructor(...e){var t,i,n;super(...e),n=e=>{const{board:t,sectionsResource:{data:i}}=this.props;return e.length>=2?[{items:Object(T.a)([t],e),customProps:{inSectionSelection:!0}},{items:Object(T.a)(i,e,"title")}]:[{items:[t],customProps:{inSectionSelection:!0}},{items:i}]},(i="getSections")in(t=this)?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n}render(){const{sectionsResource:{error:e,isLoaded:t},boardSavedTo:i,isSelectMode:n,onSectionCreate:o,onSectionSelected:a,pinId:s}=this.props;return Object(j.jsx)(C.a,{isSelectMode:n,boardSavedTo:i,createButtonLabel:r.a._("Add section","Button for creating a board section","Button for creating a board section"),hasLoadError:!!e,isLoaded:t,getSections:this.getSections,onCreate:o,onSelected:a,pinId:s})}}var B=Object(x.b)({name:"BoardSectionsRepinResource",key:"sectionsResource",options:e=>({board_id:e.board.id})})(I),R=i("Wer7"),E=i("U4JR"),k=i("ANjH");function P(e,t,i){return{...e?{pin_id:e}:{},...t?{username:t}:{},...i?{advertiser_id:i,filter:"protected"}:{},field_set_key:"board_picker",limit:undefined,shortlist_suggestions:2}}class A extends n.Component{constructor(...e){var t,i,n;super(...e),n=e=>{const{boardResource:{data:t}}=this.props;if(!t)return[];const{all_boards:i,boards_shortlist:n}=t,o=(e=>{const t=[],i=[];return e.forEach(e=>{var n;null!==(n=e.name)&&void 0!==n&&n.match(/^\d/)?i.push(e):t.push(e)}),[...t,...i]})(i);return o.length<=3?[{items:o}]:e.length>=2?[{items:Object(T.a)(o,e)}]:[n.length?{items:n,title:r.a._("Top choices")}:{items:[]},{items:o,title:r.a._("All boards","title for board picker all boards section","title for board picker all boards section")}]},(i="getSections")in(t=this)?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n}render(){const{boardResource:{data:e,error:t,isLoaded:i},boardSavedTo:n,isSelectMode:o,onBoardCreate:a,onBoardSelected:s,pinId:r}=this.props,c=i&&!!e&&e.all_boards.length<=3;return Object(j.jsx)(C.a,{isSelectMode:o,boardSavedTo:n,hasLoadError:!!t,hasLowBoardCount:c,isLoaded:i,getSections:this.getSections,onCreate:a,onSelected:s,pinId:r})}}var N=Object(k.compose)(Object(a.connect)((function(e){const{advertiser:t,viewer:i}=e;return i.isAuth&&t&&t.owner_user_id!==i.id?{advertiser_id:t.id,username:t.owner_user_id}:{}})),Object(x.b)({name:"BoardPickerBoardsResource",key:"boardResource",options:e=>P(e.pinId,e.username,e.advertiser_id)}))(A);function D(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class M extends n.Component{constructor(...e){super(...e),D(this,"state",{inviteQueue:{},newName:"",selectedSectionBoard:this.props.boardWithSection||null,showCreate:this.props.showCreate||!1}),D(this,"close",()=>{const{selectedSectionBoard:e,showCreate:t}=this.state,{onClose:i}=this.props;t&&e?this.setState({showCreate:!1},this.manageModalTitle):e?this.setState({selectedSectionBoard:null},this.manageModalTitle):i()}),D(this,"sendInvites",e=>{const{inviteQueue:t}=this.state;Object.keys(t).forEach(i=>{t[i].resource(e.id,[i])})}),D(this,"handleInvite",e=>{const{inviteQueue:t}=this.state;if(t[e.id]){const i={...t};delete i[e.id],this.setState({inviteQueue:i})}else{const i=Object.assign({},t,{[e.id]:e});this.setState({inviteQueue:i})}}),D(this,"handleBoardCreate",e=>{const{onBoardCreated:t}=this.props;this.handleBoardSave(e,!0),t&&t(e)}),D(this,"handleBoardSave",(e,t)=>{const{selectedSectionBoard:i}=this.state,{onBoardSave:n,invalidatePinBetterSaveResource:o,invalidateResource:a}=this.props;if(a(),o(),i&&"board_section"===e.type){return n(i,e,t)}const s=e,{section_count:r=0}=s;!i&&"number"==typeof r&&r>0?this.setState({selectedSectionBoard:s},this.manageModalTitle):(this.sendInvites(e),n(s,void 0,t))}),D(this,"handleCreate",e=>t=>{t=t||"",this.setState({newName:t,showCreate:!0},this.manageModalTitle);const i=e?13105:13025,n=e?10306:249;Object(E.b)(101,{component:i,element:n})}),D(this,"manageModalTitle",()=>{const{setModalTitle:e}=this.props,{selectedSectionBoard:t,showCreate:i}=this.state;e&&e(i&&t?r.a._("Add section","Repin title for making a board section","Repin title for making a board section"):i&&!t?r.a._("Create board","Repin title for making a new board","Repin title for making a new board"):t&&!i?r.a._("Choose section","Repin title for choosing a board section","Repin title for choosing a board section"):r.a._("Choose board","Repin title for choosing a board","Repin title for choosing a board"))})}render(){const{boardSavedTo:e,isRepin:t,isSelectMode:i,onToggleFlyout:n,pinId:o,preselectedCollaborators:a,setModalTitle:s,suggestedBoardTitle:r}=this.props,{newName:c,selectedSectionBoard:d,showCreate:l}=this.state,h=!!d,u=!s;return Object(j.jsxs)(m.f,{display:"flex",position:"relative",width:"100%",children:[!l&&Object(j.jsx)(m.f,{direction:"column",display:"flex",marginTop:4,width:"100%",children:d?Object(j.jsx)(B,{board:d,boardSavedTo:e,isSelectMode:i,onSectionCreate:this.handleCreate(h),onSectionSelected:this.handleBoardSave}):Object(j.jsx)(N,{boardSavedTo:e,isSelectMode:i,onBoardCreate:this.handleCreate(h),onBoardSelected:this.handleBoardSave,pinId:o})}),l&&!d&&Object(j.jsx)(S,{onCancel:this.close,onCreate:this.handleBoardCreate,onInvite:this.handleInvite,onToggleFlyout:n,pinId:o,prefilledName:c||r,preselectedCollaborators:a,showTitle:u}),l&&d&&Object(j.jsx)(w.a,{board:d,completeCreateSectionAction:this.handleBoardSave,initialName:c,isRepin:t,onClearModal:this.close,showTitle:u})]})}}var L=Object(a.connect)(null,(function(e,t){return{invalidateResource:()=>{e(Object(R.f)("BoardPickerBoardsResource",P(t.pinId)))},invalidatePinBetterSaveResource:()=>{e(Object(R.f)("BoardPickerBoardsResource",{field_set_key:"board_picker"}))}}}))(M),H=i("TgLd"),F=i("v+PR"),U=i("1inl"),W=i("K316"),z=i("TvzZ");const q="publish_actions",Y={checkFbTimelinePermission:function(e){Object(z.default)((function(t){t.api("/me/permissions",t=>{const i=t.data;let n=!1;if(i){n=!!i.find(e=>e.permission===q&&"granted"===e.status)}n?e.success&&e.success():e.error&&e.error()})}),W.a)},fbConnectedAccountMatchesLoggedInAccount:function(e,t){if(!t)return!0;const i=e.getAuthResponse();return!i||t===i.userID},maybeRequestFbTimelinePermission:function(e,t){Object(z.default)(i=>{if(!Y.fbConnectedAccountMatchesLoggedInAccount(i,t))return U.a.showError(r.a._("Oops! Your account is linked to a different Facebook account than the one you're logged into now.")),e.error&&e.error(),void(e.complete&&e.complete());Y.checkFbTimelinePermission({success(){e.success&&e.success(),e.complete&&e.complete()},error(){Y.fbLogin(e)}})},W.a)},fbLogin:function(e){Object(z.default)(t=>{t.login(t=>{t.authResponse?Y.checkFbTimelinePermission(e):e.error&&e.error(),e.complete&&e.complete()},{scope:q})},W.a)}};var K=Y,G=i("G35+"),V=i("mBfy");var Q=Object(k.compose)(Object(a.connect)(({viewer:e})=>({viewer:e}),()=>({})),Object(x.b)({name:"UserResource",key:"userSocialResource",options:e=>({user_id:e.viewer&&e.viewer.isAuth?e.viewer.id:"",field_set_key:"social_connect"})}))((function({onSocialConnect:e,userSocialResource:{data:t,isLoaded:i}}){const[o,a]=Object(n.useState)(!!(i&&t&&t.facebook_publish_stream_enabled)),[s,c]=Object(n.useState)(!!(i&&t&&t.twitter_publish_enabled));if(Object(n.useEffect)(()=>{i&&t&&(a(!!t.facebook_publish_stream_enabled),c(!!t.twitter_publish_enabled))},[t,i]),!t)return null;const{connected_to_facebook:d,twitter_url:l}=t,h=t=>{a(t),V.default.set("facebook_publish_stream_enabled",t),e(G.a.FACEBOOK,t)};return!(!d&&!l)&&Object(j.jsxs)(m.f,{display:"flex",padding:2,children:[d&&Object(j.jsxs)(m.f,{display:"flex",alignItems:"center",marginStart:2,children:[Object(j.jsx)(m.k,{checked:o,id:"share_facebook",onChange:()=>{o?h(!1):K.maybeRequestFbTimelinePermission({success:()=>h(!0),error:()=>h(!1)})},size:"sm"}),Object(j.jsx)(m.y,{htmlFor:"share_facebook",children:Object(j.jsx)(m.f,{marginStart:2,children:Object(j.jsx)(m.ab,{children:r.a._("Post to Facebook")})})})]}),l&&Object(j.jsxs)(m.f,{display:"flex",alignItems:"center",marginStart:5,children:[Object(j.jsx)(m.k,{checked:s,id:"share_twitter",onChange:()=>{const t=!s;c(t),e(G.a.TWITTER,t)},size:"sm"}),Object(j.jsx)(m.y,{htmlFor:"share_twitter",children:Object(j.jsx)(m.f,{marginStart:2,children:Object(j.jsx)(m.ab,{children:r.a._("Post to Twitter")})})})]})]})})),X=i("Sihc");var $=({board:e,completeCreateSectionAction:t,height:i,onClose:o,pinImport:s,url:c,width:d})=>{const l=Object(a.useDispatch)(),[h,u]=Object(n.useState)(""),[b,p]=Object(n.useState)(!1),[g,f]=Object(n.useState)(null);return Object(j.jsx)(H.b,{accessibilityModalLabel:r.a._("Repin modal","save.pinToBoard.modal.label","Accessibility label on modal"),heading:Object(j.jsx)(m.f,{padding:8,children:Object(j.jsx)(m.s,{alignItems:"center",children:Object(j.jsx)(m.f,{width:"66%",marginStart:"auto",children:Object(j.jsxs)(m.s,{justifyContent:"between",children:[Object(j.jsx)(m.u,{size:"md",children:r.a._("Add section","sectionCreateModal.title","Title in the add section modal")}),Object(j.jsx)(m.w,{icon:"cancel",accessibilityLabel:r.a._("Close","sectionCreateModal.closeButton","close section create modal button"),size:"md",iconColor:"darkGray",onClick:o})]})})})}),footer:Object(j.jsx)(m.s,{children:Object(j.jsx)(m.f,{marginStart:"auto",children:Object(j.jsx)(m.g,{text:r.a._("Add","sectionCreateModal.add.button","add a new section"),color:"red",onClick:()=>{e&&(p(!0),l(Object(X.a)({boardId:e.id,name:h.trim(),pinImport:s})).then(i=>{t(e,i,!1)}).catch(e=>{f(e.message||e.message_detail)}).finally(()=>{p(!1)}))},disabled:b||!h.trim()||!!g,size:"lg"})})}),onDismiss:o,size:"sm",children:Object(j.jsx)(m.f,{padding:8,children:Object(j.jsxs)(m.s,{children:[Object(j.jsx)(m.C,{rounding:4,height:i,width:d,children:Object(j.jsx)(m.x,{alt:"",fit:"cover",src:c||"",naturalHeight:i,naturalWidth:d})}),Object(j.jsx)(m.f,{marginStart:8,dangerouslySetInlineStyle:{__style:{width:`calc(100% - ${d}px)`}},children:Object(j.jsx)(m.cb,{id:"sectionEditName",onChange:e=>{u(e.value)},placeholder:r.a._('Like "Lighting"',"sectionCreateModal.boardSection.name","Placeholder for board section name"),label:r.a._("Name","section.create.label","label text for section input"),size:"lg",type:"text",value:h})})]})})})};function J(){return Object(j.jsxs)(m.f,{alignItems:"center",direction:"column",display:"flex",justifyContent:"center",children:[Object(j.jsx)(m.T,{accessibilityLabel:r.a._("Pins being saved to new sections","save.pin-to-board.PinToBoard.SectionSuggestions.SavingView","accessibility label on spinner"),show:!0}),Object(j.jsx)(m.f,{paddingY:2,children:Object(j.jsx)(m.u,{children:r.a._("Hold, please...","save.pin-to-board.PinToBoard.SectionSuggestions.SavingView","Heading on modal while saving pins")})}),Object(j.jsx)(m.ab,{children:r.a._("We're grouping the ideas you picked into sections. This will help organize all your ideas!","save.pin-to-board.PinToBoard.SectionSuggestions.SavingView","Text explaining new pins are being saved")})]})}var Z=i("82UD");function ee({index:e,pin:t,sectionName:i}){const o=t.id,a=Object(n.useContext)(ce),[s,r]=Object(n.useState)(!1),c=Object(n.useCallback)(({event:e})=>{e.preventDefault(),e.stopPropagation(),a({type:s?"unselect":"select",payload:{sectionName:i,pinId:o}}),r(!s)},[o,s]);return Object(j.jsx)(m.Z,{onTap:c,rounding:4,children:Object(j.jsx)(Z.a,{attributionOption:"hide",blockClickEvents:!0,pin:t,pinId:t.id,pinImageCrop:"none",saveButtonOptions:{type:"none"},selectionState:s?"selected-image-only":"deselected-image-only",surface:"SectionSuggestedPins",trackingParameters:{slotIndex:e}})})}var te=Object(n.memo)((function({sectionSuggestion:e,showSpinner:t}){const i=Object(n.useRef)(),o=Object(x.a)({name:"BatchP2PResource",options:{clientType:"84",page_size:10,pinIds:e.pins.map(e=>e.id)},allowStale:!1});return Object(j.jsxs)(n.Fragment,{children:[Object(j.jsx)(m.f,{display:"flex",justifyContent:"center",width:"100%",children:Object(j.jsx)(m.T,{accessibilityLabel:r.a._("Loading pins","save.pin-to-board.PinToBoard.SectionSuggestions.SectionPinsSelection","Accessibility label on a loading spinner"),show:t&&o.isFetching})}),o.data&&Object(j.jsx)(m.f,{paddingY:4,paddingX:8,children:Object(j.jsx)(m.u,{align:"left",size:"sm",children:e.name})}),Object(j.jsx)(m.f,{ref:i,children:o.data&&i&&i.current&&Object(j.jsx)(m.D,{columnWidth:152,comp:({data:t,itemIdx:i})=>Object(j.jsx)(ee,{index:i,pin:t,sectionName:e.name}),gutterWidth:16,items:o.data||[],loadItems:()=>{},scrollContainer:()=>i.current})})]})}),(e,t)=>e.sectionSuggestion.id===t.sectionSuggestion.id);function ie({canSubmit:e,handleClose:t,handleSubmit:i,sectionSuggestions:o}){Object(n.useEffect)(()=>{const e=[];o.forEach(t=>e.push(t.name)),Object(E.b)(13,{suggested_section_names_viewed:e,view:1,viewParameter:3461})},[o]);return Object(j.jsx)(n.Fragment,{children:Object(j.jsxs)(m.f,{width:"100%",children:[Object(j.jsx)(m.f,{minHeight:"100%",marginBottom:12,width:"100%",children:o.map((e,t)=>Object(j.jsx)(m.f,{marginBottom:4,children:Object(j.jsx)(te,{sectionSuggestion:e,showSpinner:0===t})},e.name))}),Object(j.jsx)(m.f,{bottom:!0,color:"white",dangerouslySetInlineStyle:{__style:{boxShadow:"0px 0px 8px rgba(0, 0, 0, 0.1)",position:"sticky"}},display:"flex",justifyContent:"end",padding:4,width:720,children:Object(j.jsx)(m.g,{color:e?"red":"gray",inline:!0,size:"lg",text:e?r.a._("Next","save.pin-to-board.PinToBoard.SectionPinsWrapper","Button to submit form selections"):r.a._("Skip","save.pin-to-board.PinToBoard.SectionPinsWrapper","Button to submit form selections"),onClick:()=>{e?i():t()}})})]})})}function ne({handleClose:e,handleSubmit:t,suggestions:i}){const[o,a]=Object(n.useState)({}),s=!!Object.keys(o).length;return Object(j.jsxs)(m.f,{children:[Object(j.jsx)(m.f,{display:"flex",alignItems:"center",dangerouslySetInlineStyle:{__style:{height:"calc(100% - 88px)"}},children:Object(j.jsx)(m.f,{display:"flex",wrap:!0,height:360,paddingX:6,children:i.map(e=>Object(j.jsx)(m.f,{paddingX:1,height:160,children:Object(j.jsx)(m.Z,{onTap:()=>{const t={...o};t[e.name]?delete t[e.name]:t[e.name]=e,a(t)},rounding:6,children:Object(j.jsx)(m.f,{rounding:7,dangerouslySetInlineStyle:{__style:{border:o[e.name]?"2px solid #111":"2px solid white",padding:"2px"}},children:Object(j.jsxs)(m.f,{height:160,width:152,position:"relative",rounding:6,children:[Object(j.jsx)(m.C,{rounding:6,height:160,width:152,children:Object(j.jsx)(m.x,{alt:e.name,fit:"cover",naturalHeight:e.images["236x"].height,naturalWidth:e.images["236x"].width,src:e.images["236x"].url})}),Object(j.jsx)(m.f,{alignItems:"center",dangerouslySetInlineStyle:{__style:{background:"rgba(0, 0, 0, 0.3)"}},display:"flex",height:160,justifyContent:"center",left:!0,paddingX:5,position:"absolute",rounding:6,top:!0,width:152,children:Object(j.jsx)(m.u,{align:"center",color:"white",size:"sm",children:e.name})})]})})})},e.name))})}),Object(j.jsx)(m.f,{display:"flex",width:"100%",justifyContent:"end",padding:5,children:Object(j.jsx)(m.g,{color:s?"red":"gray",inline:!0,size:"lg",text:s?r.a._("Next","save.pin-to-board.SectionSuggestionPicker","Button to submit form selections"):r.a._("Skip","save.pin-to-board.SectionSuggestionPicker","Button to submit form selections"),onClick:()=>{s?t(Object.values(o)):e()}})})]})}var oe=i("M1Uz"),ae=i("6G9P"),se=i("EC67"),re=i("nGHF");const ce=Object(n.createContext)();function de(e,t){const{sectionName:i,pinId:n}=t.payload,o=[...e[i]||[]];switch(t.type){case"select":return{...e,[i]:[...o,n]};case"unselect":const t=o.indexOf(n);if(o.splice(t,1),!o.length){const t={...e};return delete t[i],t}return{...e,[i]:o};default:throw new Error("Unsupported action received by PinSelectionReducer")}}function le({board:e,handleClose:t,setModalTitle:i,suggestions:o}){const[s,c]=Object(n.useState)("sections"),[d,l]=Object(n.useState)([]),[h,u]=Object(n.useState)([]),[b,p]=Object(n.useReducer)(de,{}),{showOneToast:m}=Object(re.b)(),g=Object(a.useDispatch)(),f=Object(se.h)(),x=Object(n.useRef)(null);Object(n.useEffect)(()=>()=>{x.current&&clearTimeout(x.current)},[]),Object(n.useEffect)(()=>{const e=[];o.forEach(t=>e.push(t.name)),u(e)},[o]);const O=()=>{Object(E.b)(101,{component:20,view:52})},y=()=>{t(),m(({onHide:t})=>{var i;return Object(j.jsx)(oe.a,{duration:pe,onHide:t,text:Object(ae.a)(e.name),href:e.url,imageUrl:null!==(i=e.image_cover_url)&&void 0!==i?i:"",onClick:O})}),Object(E.b)(101,{element:1150,view:1,viewParameter:3460,suggested_section_names:h})};return{sections:Object(j.jsx)(ne,{handleClose:y,handleSubmit:e=>{l(e),c("pins"),i&&i(r.a._("Great! Now pick some ideas to start off with.","save.pin-to-board.PinToBoard.SectionSuggestions.SectionSuggestionContainer","Modal title for choosing ideas for a new board"));const t=[];e.forEach(e=>t.push(e.name)),Object(E.b)(101,{element:96,suggested_section_names_selected:t,suggested_section_names_viewed:h,view:1,viewParameter:3460})},suggestions:o}),pins:Object(j.jsx)(ce.Provider,{value:p,children:Object(j.jsx)(ie,{canSubmit:!!Object.keys(b).length,handleClose:y,handleSubmit:()=>{let t=0;c("saving"),i&&i(null);const n=d.reduce((e,t)=>(e[t.name]=null,e),{});let o=0;const a=[];Object.entries({...n,...b}).forEach(([i,n])=>{o+=Array.isArray(n)&&n.length,a.push({[i]:n}),g(Object(X.a)({boardId:e.id,initialPinIds:n,name:i})).then(()=>{t+=1,t===d.length&&(x.current=setTimeout(()=>{var t;f.push(null!==(t=e.url)&&void 0!==t?t:"")},1500),Object(E.b)(101,{element:76,number_pins_selected:o,number_sections_selected:d.length,selected_pin_ids:JSON.stringify(a),suggested_section_names:h,view:1,viewParameter:3460}))})})},sectionSuggestions:d})}),saving:Object(j.jsx)(J,{})}[s]}var he=i("Yo6N"),ue=i("QAzJ");function be(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const pe=4e3,me={LOADING:"loading",SUCCESS:"success"};class je extends n.PureComponent{constructor(...e){super(...e),be(this,"state",{isFlyoutOpen:!1,isSavingPin:!1,newBoard:null}),be(this,"pinImageRef",Object(n.createRef)()),be(this,"unmounted",!1),be(this,"handleSavePinToBoard",(e,t,i)=>{const{handleSaveToBoard:n,sectionSuggestions:o,setModalTitle:a}=this.props;n(e,t,i),i&&(this.setState({isSavingPin:!0,newBoard:e}),o&&o.length>0&&a&&a(r.a._("Let's build out your new board! What topics will it include?","save.pin-to-board.PinToBoard.SectionPickerModalTitle","Modal title for selection recommended sections for a new board")))}),be(this,"handleToggleFlyout",()=>this.setState({isFlyoutOpen:!this.state.isFlyoutOpen})),be(this,"safeSetState",(e,t)=>{this.unmounted?t&&t():this.setState(e,t)}),be(this,"close",()=>{const{isFlyoutOpen:e}=this.state,{handleAbort:t}=this.props;e||t()}),be(this,"dismissModal",e=>{const{dismissModal:t}=this.props;t&&t()})}componentWillUnmount(){this.unmounted=!0}render(){const{activateRemoveBoardSectionUpsell:e,boardSavedTo:t,boardWithSection:i,color:a,displaySuccessAnimation:s,handleNewBoardAnimationCompletion:c,handleSocialConnectSet:d,isInModal:l,newPin:h,pin:u,preselectedCollaborators:b,onBoardCreated:p,sectionSuggestions:g,sensitiveContentNotice:f,setModalTitle:x,showCreate:O,shouldRenderContent:y,suggestedBoardTitle:v,updateDescription:_}=this.props;if(!u||!u&&!u.resourceLoaded||!y)return null;const{isSavingPin:S,newBoard:w}=this.state;if(O&&i){var C;const{url:e,width:t,height:n}=(null===(C=u.images)||void 0===C?void 0:C["236x"])||{};return Object(j.jsx)($,{board:i,url:e,height:n,width:t,onClose:this.close,completeCreateSectionAction:this.handleSavePinToBoard})}let T=null;h&&h.board&&(T=h.board.name);const I=f&&f.title||this.props.modalTitle,B=f?Object(j.jsx)(he.a,{inModal:!0,notices:[f]}):Object(j.jsx)(m.f,{display:"flex",height:"calc(90vh - 97px)",justifyContent:"center",maxHeight:"703px",width:"100%",children:S&&w&&g&&g.length>0&&!e().group.startsWith("enabled")?Object(j.jsx)(le,{board:w,handleClose:this.close,setModalTitle:x,suggestions:g}):Object(j.jsxs)(n.Fragment,{children:[Object(j.jsxs)(m.f,{color:"white",display:"flex",height:"100%",overflow:"hidden",position:"relative",rounding:2,width:"100%",children:[Object(j.jsxs)(m.f,{direction:"column",display:"flex",justifyContent:"between",width:"40%",children:[Object(j.jsx)(m.f,{alignItems:"center",direction:"column",display:"flex",flex:"grow",justifyContent:"start",marginTop:3,children:Object(j.jsx)(F.a,{color:a,pin:u,pinImageRef:this.pinImageRef,updateDescription:_})}),Object(j.jsx)(Q,{onSocialConnect:d})]}),Object(j.jsx)(m.f,{display:"flex",width:"60%",children:Object(j.jsx)(L,{boardSavedTo:t,boardWithSection:i,isRepin:!0,onBoardCreated:p,onBoardSave:this.handleSavePinToBoard,onClose:this.close,onToggleFlyout:this.handleToggleFlyout,pinId:u.id,preselectedCollaborators:b,setModalTitle:l?x:void 0,showCreate:O,suggestedBoardTitle:v})})]}),s&&Object(j.jsx)(o.a,{onDismiss:()=>{c(),this.dismissModal()},pin:u,pinImageRef:this.pinImageRef,selectedBoardName:T})]})});return l?Object(j.jsx)(H.b,{accessibilityModalLabel:I||r.a._("Repin modal","save.pin-to-board.PinToBoard.PinToBoard","Accessibility label on modal"),heading:I,onDismiss:this.close,size:"md",children:B}):B}}be(je,"defaultProps",{pwtAuxData:{}});t.c=function(e){const t=Object(ue.b)("web_remove_board_section_upsell");return Object(j.jsx)(je,{...e,activateRemoveBoardSectionUpsell:t})}},NjDU:function(e,t,i){function n(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}function o(e){return{type:"UPDATE_USER_FOLLOWING_COUNT",payload:e}}function a(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}function s(e,t){return{type:"UPDATE_USER_SOCIAL_NETWORK",payload:{socialNetworkName:e,connected:t}}}i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return o})),i.d(t,"d",(function(){return a})),i.d(t,"e",(function(){return s})),i.d(t,"g",(function(){return r})),i.d(t,"f",(function(){return c})),i.d(t,"a",(function(){return d}));const r=e=>({type:"USER_DOMAIN_VERIFIED",payload:{verifiedWebsite:e}}),c=e=>({type:"USER_DOMAIN_UNVERIFIED",payload:{verifiedWebsite:e}});function d(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}},P6kd:function(e,t,i){i.d(t,"a",(function(){return b}));var n=i("q1tI"),o=i("Ye/N"),a=i("oRao"),s=i("eOdZ"),r=i("Sbkd"),c=i("vvax"),d=i("n6mq"),l=i("nKUr");function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class u extends n.Component{constructor(...e){super(...e),h(this,"state",{recommendations:[],selectedIndex:0,resourceLoaded:!1}),h(this,"onDismiss",()=>{}),h(this,"mounted",!1),h(this,"addHashtag",e=>{this.props.addHashtag(e),this.setState({recommendations:[]})}),h(this,"handleKeyDown",e=>{38===e.keyCode?this.handlePrevHashtag(e):40===e.keyCode?this.handleNextHashtag(e):27===e.keyCode?this.handleClose(e):13===e.keyCode&&this.handleSubmit(e)}),h(this,"handlePrevHashtag",e=>{e.preventDefault(),this.state.selectedIndex>0&&this.setState(e=>({selectedIndex:e.selectedIndex-1}))}),h(this,"handleNextHashtag",e=>{e.preventDefault(),this.state.selectedIndex<this.state.recommendations.length-1&&this.setState(e=>({selectedIndex:e.selectedIndex+1}))}),h(this,"handleClose",e=>{e.preventDefault(),this.setState({recommendations:[]})}),h(this,"handleSubmit",e=>{e.preventDefault(),this.addHashtag(this.state.recommendations[this.state.selectedIndex].query)}),h(this,"callResource",e=>{const{makeCancelablePromise:t}=this.props;t(s.a.create("HashtagTypeaheadResource",{query:e,showPinCount:!0}).callGet(),"typeahead").then(e=>{if(!this.mounted)return;const t=e.resource_response.data;this.setState({recommendations:t.slice(0,5),resourceLoaded:!0})}).catch(({isCanceled:e})=>{e||this.setState({resourceLoaded:!1})})})}componentDidMount(){this.mounted=!0,this.callResource(this.props.query),window.addEventListener("keydown",this.handleKeyDown)}componentDidUpdate(e){this.props.query!==e.query&&""!==this.props.query&&this.callResource(this.props.query)}componentWillUnmount(){window.removeEventListener("keydown",this.handleKeyDown),this.mounted=!1}render(){const{recommendations:e,resourceLoaded:t,selectedIndex:i}=this.state,{anchor:n,idealDirection:s}=this.props,r=e.filter(e=>e.query),h=s||"down",u="flyout_"+r.length;return t&&r.length>0?Object(l.jsx)("div",{className:"HashtagFlyout",children:Object(l.jsx)(d.J,{anchor:n,idealDirection:h,onDismiss:this.onDismiss,size:"sm",children:Object(l.jsx)("div",{className:"HashtagRecommendations",children:r.length>0?r.map((e,t)=>Object(l.jsx)("div",{className:"HashtagItem",children:Object(l.jsx)(d.Z,{fullWidth:!1,onTap:()=>this.addHashtag(e.query),children:Object(l.jsxs)(d.f,{display:"flex",justifyContent:"between",alignItems:"center",color:t===i?"lightGray":"transparent",padding:1,children:[Object(l.jsx)(d.f,{flex:"grow",children:Object(l.jsx)(d.ab,{inline:!0,size:"md",weight:"bold",children:e.query})}),Object(l.jsx)(d.f,{flex:"none",children:Object(l.jsx)(d.ab,{inline:!0,size:"sm",children:Object(c.b)(o.a.ngettext("{{ count }} pin","{{ count }} pins",Number(e.pin_count),"label for n pins in hashtag flyout","label for n pins in hashtag flyout"),{count:Object(l.jsx)(a.a,{value:Number(e.pin_count)},"pinCount")})})})]})})},e.query)):null})},u)}):null}}function b(e){const t=Object(r.a)();return Object(l.jsx)(u,{...e,makeCancelablePromise:t})}},Pqnw:function(e,t,i){function n(e,t){return{type:"FEED_INVALIDATE",payload:{feedType:e,feedId:t}}}i.d(t,"a",(function(){return n}))},Sbkd:function(e,t,i){i.d(t,"a",(function(){return a}));var n=i("q1tI"),o=i("mvLR");function a(){const e=Object(n.useRef)([]),t=Object(n.useRef)({});return Object(n.useEffect)(()=>()=>{[...Object.keys(t.current).map(e=>t.current[e]),...e.current].forEach(e=>e())},[]),function(i,n){if(n){const e=t.current[n];e&&(e(),delete t.current[n])}const{cancel:a,promise:s}=Object(o.a)(i);return n?t.current[n]=a:e.current.push(a),s}}},Wrea:function(e,t,i){i.d(t,"e",(function(){return o})),i.d(t,"f",(function(){return a})),i.d(t,"d",(function(){return s})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d}));var n=i("Wer7");const o=(e,t)=>i=>i(Object(n.a)("BoardResource",{board_id:e,field_set_key:t})),a=e=>o(e,"pin_count"),s=e=>({type:"BOARD_PIN_COUNT_CHANGED",payload:e}),r=e=>({type:"BOARD_INVITE_ACCEPTED_BY_VIEWER",payload:{boardId:e}}),c=(e,t)=>({type:"BOARD_COVER_IMAGE_UPDATED",payload:{boardId:e,coverPin:t}}),d=e=>({type:"BOARD_DISABLE_MORE_IDEAS_BADGING",payload:{boardId:e}})},Yo6N:function(e,t,i){i.d(t,"b",(function(){return m})),i.d(t,"a",(function(){return j}));var n=i("q1tI"),o=i("qD10"),a=i("n6mq"),s=i("nKUr");function r({action:e,alignCenter:t}){const{title:i,description:n,button:r}=e,c=i&&i.text,d=n&&n.text,l=r&&r.text||"",h=r&&r.link||"",u=r&&r.link?r.link.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"").replace("/",""):"";return r&&l&&h.startsWith("http")?Object(s.jsxs)(a.f,{children:[Object(s.jsx)(a.f,{marginBottom:1,children:Object(s.jsx)(a.ab,{align:t?"center":"left",weight:"bold",children:""!==l?l:"Visit"})}),Object(s.jsx)(a.f,{marginBottom:1,children:Object(s.jsx)(o.a,{className:"underlineLink",to:h,children:Object(s.jsx)("span",{style:{textDecoration:"underline"},children:Object(s.jsx)(a.ab,{align:t?"center":"left",truncate:!0,children:u})})})})]}):Object(s.jsxs)(a.f,{children:[!!c&&Object(s.jsx)(a.f,{marginBottom:1,children:Object(s.jsx)(a.ab,{align:t?"center":"left",weight:"bold",children:c})}),!!d&&Object(s.jsx)(a.f,{marginBottom:1,children:Object(s.jsx)(a.ab,{align:t?"center":"left",children:d})})]})}const c={backgroundColor:"#E1F8F7",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.04)"},d={boxShadow:"0 4px 16px rgba(0, 0, 0, 0.04)"};function l({inModal:e,notice:t}){const{title:i,description:n,actions:o=[]}=t,l=n&&n.text||"",h=n&&n.text_tags||[],u=1===o.length,b=m(l,h);return Object(s.jsxs)(a.f,{rounding:2,padding:6,dangerouslySetInlineStyle:{__style:e?d:c},children:[!!i&&!e&&Object(s.jsx)(a.f,{marginBottom:2,display:"flex",children:Object(s.jsx)(a.u,{size:"md",children:i})}),!!l&&Object(s.jsx)(a.f,{marginBottom:4,children:Object(s.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:Object(s.jsx)(a.ab,{overflow:"normal",align:e?"center":"left",children:b})})}),!!o.length&&Object(s.jsx)(a.f,{display:"flex",wrap:!0,marginStart:-2,marginEnd:-2,direction:e?"column":"row",children:o.map(t=>Object(s.jsx)(a.f,{column:e||u?12:6,paddingY:1,paddingX:2,children:Object(s.jsx)(r,{action:t,alignCenter:e||u})},JSON.stringify(t)))})]})}var h=i("EC51");function u({notice:e}){const{actions:t=[],description:i,footer:n}=e,o=m(i&&i.text||"",i&&i.text_tags||[]),r={color:"#004b91",display:"block",fontSize:"28px",WebkitFontSmoothing:"antialiased"};return Object(s.jsxs)(a.f,{width:"100%",display:"flex",direction:"column",alignItems:"center",marginBottom:3,children:[Object(s.jsx)(a.f,{dangerouslySetInlineStyle:{__style:{backgroundColor:"#86d1ce"}},display:"flex",justifyContent:"center",width:656,rounding:8,children:Object(s.jsxs)(a.f,{height:"100%",width:"100%",padding:10,children:[Object(s.jsx)("span",{style:r,children:o}),Object(s.jsx)(a.f,{marginTop:6,children:t.map(e=>{var t;const i=null===(t=e.button)||void 0===t?void 0:t.link;var n,o,c;return i&&i.startsWith("tel")?Object(s.jsxs)(a.f,{children:[Object(s.jsx)("span",{style:{fontWeight:"600",...r},children:null===(n=e.title)||void 0===n?void 0:n.text}),Object(s.jsx)("span",{style:r,children:null===(o=e.description)||void 0===o?void 0:o.text})]}):Object(s.jsx)(h.a,{href:i||"",children:Object(s.jsx)(a.f,{display:"inlineBlock",children:Object(s.jsx)(a.f,{alignItems:"center",color:"navy",display:"flex",justifyContent:"center",height:44,rounding:"pill",width:117,children:Object(s.jsx)(a.ab,{color:"white",weight:"bold",children:(null===(c=e.button)||void 0===c?void 0:c.text)||""})})})})})})]})}),!!n&&Object(s.jsx)(a.f,{paddingY:2,width:540,children:Object(s.jsx)(h.a,{inline:!0,target:"blank",href:n.link,children:Object(s.jsx)(a.ab,{align:"center",color:"gray",size:"sm",children:Object(s.jsx)("div",{dangerouslySetInnerHTML:{__html:n.text}})})},n.link)})]})}var b=i("hZxF"),p=i("U4JR");function m(e,t){const i=[];let n=0;for(let o=0;o<t.length;o+=1){const r=t[o];if(5===r.tag_type&&r.link){const t=e.substring(r.offset,r.offset+r.length),o=Object(s.jsx)(a.ab,{inline:!0,weight:"bold",children:Object(s.jsx)(h.a,{inline:!0,target:"blank",href:r.link,children:t},t)});i.push(Object(s.jsx)("span",{children:e.substring(n,r.offset)})),i.push(o),n=r.offset+r.length}}return n>0&&i.push(Object(s.jsx)("span",{children:e.substring(n)})),0===i.length?[Object(s.jsx)("span",{children:e})]:i}function j({inModal:e,notices:t,viewType:i,query:o,sensitivity:a}){return Object(b.a)(()=>{i&&Object(p.b)(120,{component:13367,view:i,entered_query:o,advisory_details:null==a?void 0:a.advisory_details,advisory_level:null==a?void 0:a.advisory,severity_level:null==a?void 0:a.severity})}),Object(s.jsx)(n.Fragment,{children:t.map(t=>2===t.style?Object(s.jsx)(u,{notice:t}):Object(s.jsx)(l,{notice:t,inModal:e}))})}},ZE2w:function(e,t,i){i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d}));var n=i("4dcN"),o=i("eOdZ");const a="collaborator_approve_invite";function s(e,t){return o.a.create("BoardEmailInviteResource",{board_id:e,emails:t}).callCreate()}function r(e,t){return o.a.create("BoardInviteResource",{board_id:e,invited_user_ids:t}).callCreate()}function c(e,t){return i=>o.a.create("BoardInviteResource",{board_id:e,invited_user_id:t}).callUpdate().then(()=>{n.a.trackEvent(a,"success")}).catch(()=>n.a.trackEvent(a,"error"))}function d(e,t,i){return t=>{const{invited_user:n,status:a,board:{id:s}}=e;return o.a.create("accepted"===a?"BoardCollaboratorResource":"BoardInviteResource",{ban:i,board_id:s,field_set_key:"boardEdit",invited_user_id:n.id}).callDelete({showError:!1})}}},"b/K5":function(e,t,i){i.d(t,"a",(function(){return g}));var n=i("q1tI"),o=i("n6mq"),a=i("nKUr");function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const r=["#0074e8","#0FA573","#B469EB","#F13535","#E2780D"],c=(e,t)=>Math.random()*((e||1)-(t||0))+(t||0),d=e=>e*(Math.PI/180);class l extends n.PureComponent{constructor(...e){super(...e),s(this,"animationTimer",null),s(this,"canvasRemovalTimer",null),s(this,"containerRef",Object(n.createRef)()),s(this,"buildCanvas",()=>{if(!this.containerRef.current)return null;const{height:e,width:t}=this.containerRef.current.getBoundingClientRect(),i=2.5*e,n=document.createElement("canvas");return n.style.position="absolute",n.style.left=0-(i-t)/2+"px",n.style.top=0-(i-e)/2+"px",n.style.pointerEvents="none",n.style.width=i+"px",n.style.height=i+"px",n.style.overflow="visible",n.width=i,n.height=i,n}),s(this,"explode",()=>{const e=this.buildCanvas(),t=this.containerRef.current;if(!e||!t)return;const i=e.getContext("2d");t.prepend(e);const n=Array.from(Array(120)).map(()=>({x:e.width/2,y:e.height/2,radius:Math.round(c(10,30)),color:r[Math.floor(Math.random()*r.length)],degree:Number(c(0,360).toFixed(1)),speed:Math.round(c(0,25)),friction:.9,opacity:Number(c(0,.5).toFixed(1)),yVel:0,gravity:.04})),o=(e,t,i,n)=>{window.requestAnimationFrame(()=>o(e,t,i,n)),t.clearRect(0,0,i,n),e.forEach((e,i)=>{e.x+=e.speed*Math.cos(d(e.degree)),e.y+=e.speed*Math.sin(d(e.degree)),e.opacity-=.01,e.speed*=e.friction,e.radius*=e.friction,e.yVel+=e.gravity,e.y+=e.yVel,e.opacity<0||e.radius<0||(t.beginPath(),t.globalAlpha=e.opacity,t.fillStyle=e.color,t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.fill())})};o(n,i,e.width,e.height),this.canvasRemovalTimer=setTimeout(()=>{t.removeChild(e)},(this.props.delay||0)+800)})}componentDidUpdate(e){const{delay:t,startAnimation:i}=this.props,{startAnimation:n}=e;i&&n!==i&&(this.animationTimer=setTimeout(this.explode,t))}componentWillUnmount(){this.animationTimer&&clearTimeout(this.animationTimer),this.canvasRemovalTimer&&clearTimeout(this.canvasRemovalTimer)}render(){return Object(a.jsx)(o.f,{ref:this.containerRef,position:"relative",children:this.props.children})}}s(l,"defaultProps",{delay:0});var h=l,u=i("Ye/N"),b=i("vvax");function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const m=e=>({opacity:e?1:0,WebkitTransition:"opacity .5s ease-in-out .75s",transition:"opacity .5s ease-in-out .75s",overflow:"visible"}),j=e=>({opacity:e?1:0,WebkitTransform:e?"translateY(0)":"translateY(20%)",transform:e?"translateY(0)":"translateY(20%)",WebkitTransition:"all .5s ease-in-out .75s",transition:"all .5s ease-in-out .75s",textAlign:"center",marginTop:"24px"});class g extends n.PureComponent{constructor(...e){super(...e),p(this,"state",{isInitialized:!1}),p(this,"containerRef",Object(n.createRef)()),p(this,"pinDestinationRef",Object(n.createRef)())}componentDidMount(){this.requestAnimationFrameId=window.requestAnimationFrame(()=>{this.setState({isInitialized:!0})})}componentWillUnmount(){this.dismissTimeout&&clearTimeout(this.dismissTimeout)}componentDidUpdate(e,t){const{isInitialized:i}=this.state,{onDismiss:n}=this.props;i&&n&&!this.dismissTimeout&&(this.dismissTimeout=setTimeout(n,2600))}render(){const{firstRepin:e,pin:t,pinImageRef:i,selectedBoardName:s}=this.props,{description:r="",images:c}=t,{height:d=0,width:l=0,url:p=""}=(null==c?void 0:c["236x"])||{},{isInitialized:g}=this.state,{mask:f,imageContainer:x}=((e,t,i,n)=>{var o,a,s;let r,c,d={};const l=null===(o=i.current)||void 0===o?void 0:o.getBoundingClientRect(),h=null===(a=t.current)||void 0===a?void 0:a.getBoundingClientRect(),u=null===(s=n.current)||void 0===s?void 0:s.getBoundingClientRect();if(h&&l&&u){d={left:l.left-h.left,top:l.top-h.top};const e={x:u.left-l.left,y:u.top-l.top},t={x:(u.width-l.width)/2,y:(u.height-l.height)/2};r=`translate(${e.x}px, ${e.y}px)`,c=`translate(${t.x}px, ${t.y}px)`}return{mask:{position:"absolute",left:d.left,top:d.top,width:e?null==u?void 0:u.width:null==l?void 0:l.width,height:e?null==u?void 0:u.height:null==l?void 0:l.height,WebkitTransformOrigin:"left top",transformOrigin:"left top",WebkitTransform:e?r:"none",transform:e?r:"none",WebkitTransition:"all .5s ease-in-out .25s",transition:"all .5s ease-in-out .25s",borderRadius:e?"8px 0px 0px 8px":"8px",zIndex:2},imageContainer:{width:null==l?void 0:l.width,height:null==l?void 0:l.height,WebkitTransformOrigin:"left top",transformOrigin:"left top",WebkitTransform:e?c:"none",transform:e?c:"none",WebkitTransition:"all .5s ease-in-out .25s",transition:"all .5s ease-in-out .25s"}}})(g,this.containerRef,i,this.pinDestinationRef);return Object(a.jsx)(n.Fragment,{children:Object(a.jsxs)(o.f,{position:"absolute",top:!0,bottom:!0,right:!0,left:!0,ref:this.containerRef,children:[Object(a.jsx)(o.f,{maxHeight:335,overflow:"hidden",dangerouslySetInlineStyle:{__style:f},children:Object(a.jsx)(o.f,{dangerouslySetInlineStyle:{__style:x},children:Object(a.jsx)(o.x,{alt:null!=r?r:"",src:p||"",naturalHeight:d||1,naturalWidth:l||1})})}),Object(a.jsx)(o.f,{color:"white",position:"absolute",top:!0,bottom:!0,right:!0,left:!0,dangerouslySetInlineStyle:{__style:(O=g,{pointerEvents:"none",opacity:O?1:0,WebkitTransition:"opacity .3s ease-in-out",transition:"opacity .3s ease-in-out",zIndex:1})},children:Object(a.jsxs)(o.f,{display:"flex",justifyContent:"center",alignItems:"center",direction:"column",height:"100%",dangerouslySetInlineStyle:{__style:m(g)},children:[Object(a.jsx)(h,{delay:1250,startAnimation:g,children:Object(a.jsx)(o.C,{rounding:2,width:270,height:180,children:Object(a.jsxs)(o.f,{display:"flex",height:"100%",width:"100%",children:[Object(a.jsx)(o.f,{ref:this.pinDestinationRef,color:"transparent",marginEnd:1,flex:"grow",height:"100%"}),Object(a.jsxs)(o.f,{display:"flex",width:80,direction:"column",children:[Object(a.jsx)(o.f,{color:"lightGray",flex:"grow",marginBottom:1}),Object(a.jsx)(o.f,{color:"lightGray",flex:"grow"})]})]})})}),Object(a.jsx)(o.f,{paddingX:2,dangerouslySetInlineStyle:{__style:j(g)},children:Object(a.jsx)(o.u,{align:"center",children:e?Object(b.b)(u.a._("You saved your first Pin to {{ selectedBoardName }}!","First board create confirmation message","First board create confirmation message"),{selectedBoardName:null!=s?s:""}):Object(b.b)(u.a._("You saved this Pin to {{ selectedBoardName }}!","Board create confirmation message","Board create confirmation message"),{selectedBoardName:null!=s?s:""})})})]})})]})});var O}}p(g,"defaultProps",{firstRepin:!1})},"g/XF":function(e,t,i){i.d(t,"a",(function(){return r}));var n=i("JW66"),o=i("zwad"),a=i("n6mq"),s=i("nKUr");function r({url:e,description:t,color:i}){return i=i||n.a.DEFAULT_IMAGELESS_PIN_COLOR,Object(s.jsx)(a.f,{rounding:2,height:216,width:"100%",dangerouslySetInlineStyle:{__style:{background:i}},children:Object(s.jsxs)(a.f,{maxHeight:200,padding:4,overflow:"hidden",children:[e&&Object(s.jsx)(a.f,{marginBottom:2,children:Object(s.jsx)(a.ab,{color:"white",size:"sm",children:o.a.parse(e).hostname||e})}),Object(s.jsx)(a.f,{maxHeight:144,children:Object(s.jsx)(a.ab,{color:"white",overflow:"normal",weight:"bold",children:t})})]})})}},gONw:function(e,t,i){var n=i("q1tI"),o=i("n6mq"),a=i("nKUr");function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class r extends n.Component{constructor(...e){super(...e),s(this,"state",{isHovering:!1}),s(this,"onHover",()=>{this.setState({isHovering:!0})}),s(this,"offHover",()=>{this.setState({isHovering:!1})})}render(){const{name:e,selected:t,image:i,inFlyoutExp:n}=this.props;return n?Object(a.jsxs)(o.f,{alignItems:"center",color:this.state.isHovering?"lightGray":"transparent",direction:"row",display:"flex",paddingX:4,paddingY:2,onMouseOver:this.onHover,onMouseOut:this.offHover,children:[Object(a.jsx)(o.f,{children:Object(a.jsx)(o.C,{height:40,width:40,rounding:2,children:this.state.isHovering&&i?Object(a.jsx)(o.x,{alt:"",color:"",fit:"cover",naturalHeight:i.height,naturalWidth:i.width,src:i.url}):Object(a.jsx)(o.f,{color:"lightGray",height:40,width:40})})}),Object(a.jsx)(o.f,{padding:2,children:Object(a.jsx)(o.u,{size:"sm",children:e})})]}):Object(a.jsxs)(o.f,{alignItems:"center",color:t?"lightGray":"transparent",direction:"row",display:"flex",paddingX:6,paddingY:2,children:[Object(a.jsx)(o.f,{children:Object(a.jsx)(o.v,{color:t?"darkGray":"gray",icon:"add",accessibilityLabel:""})}),Object(a.jsx)(o.f,{marginStart:3,children:Object(a.jsx)(o.ab,{color:t?"darkGray":"gray",weight:"bold",children:e})})]})}}var c=i("Ye/N"),d=i("w70y"),l=i("U4JR"),h=i("seP0");t.a=({inFlyoutExp:e,inFirstBoardCreateGestaltExp:t,pinId:i,image:s,minHeight:u,onBoardSelected:b})=>{const[p,m]=Object(n.useState)(-1),j=Object(h.c)(),{data:g=[],error:f,isLoaded:x}=Object(d.a)({name:"BoardTitleSuggestionsResource",options:{pin_id:i}}),O=(y=g,Object(n.useMemo)(()=>y&&y.length?y.map(e=>e.title):[],[y]));var y;Object(n.useEffect)(()=>{x&&t&&j&&(f?j.error():j.stop())},[x]);const v=()=>{m(-1)},_=(t,i)=>{const n=p===i;return Object(a.jsx)("li",{children:Object(a.jsx)(o.Z,{onMouseEnter:()=>(e=>{m(e)})(i),onMouseLeave:v,onTap:()=>(e=>{b(O[e],!1),Object(l.b)(101,{component:13025,element:23})})(i),children:Object(a.jsx)(r,{selected:n,name:t,inFlyoutExp:e,image:s})})},i)};return x?O&&O.length?e?Object(a.jsx)("div",{children:Object(a.jsx)("ul",{children:O.map(_)})}):t?Object(a.jsxs)(o.f,{children:[Object(a.jsx)(o.f,{marginTop:5,marginStart:6,marginBottom:3,children:Object(a.jsx)(o.ab,{children:c.a._("Suggested board names","text above suggested board names list","text above suggested board names list")})}),Object(a.jsx)("ul",{children:O.map(_)})]}):Object(a.jsxs)(o.f,{children:[Object(a.jsx)(o.f,{marginTop:2,paddingX:5,children:Object(a.jsx)(o.ab,{children:c.a._("Suggested board names")})}),Object(a.jsx)("ul",{children:O.map(_)})]}):null:Object(a.jsx)(o.f,{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",minHeight:u||"",children:Object(a.jsx)(o.T,{accessibilityLabel:c.a._("Loading board suggestions","Accesibility label for loading board suggestions","Accesibility label for loading board suggestions"),show:!0})})}},lm6u:function(e,t,i){i.d(t,"a",(function(){return E}));var n=i("q1tI"),o=i("/MKj"),a=i("1inl"),s=i("3z7j"),r=i("ajUs"),c=i("Ye/N");var d=i("x12c"),l=i("eOdZ"),h=i("G35+"),u=i("M1Uz"),b=i("Wrea"),p=i("ANjH"),m=i("Vzit"),j=i("xjIv"),g=i("WnNx"),f=i("n6mq"),x=i("U4JR"),O=i("NjDU"),y=i("6G9P"),v=i("B6Tf"),_=i("seP0"),S=i("nGHF"),w=i("oN2T"),C=i("EC67"),T=i("nKUr");function I(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const B=/#[^(\-\\.\s#,\/$%\^&\*;:{}=\`~()\[\]@|<>…)]+/gi;class R extends n.Component{constructor(...e){super(...e),I(this,"state",{boardSavedTo:null,displaySuccessAnimation:!1,newPin:null,modalTitle:this.getModalTitle(this.props.showCreate,this.props.boardWithSection),pinDescription:this.props.pin&&this.props.pin.description||"",resolve:void 0,sharing:{facebook:!1,twitter:!1}}),I(this,"unmounted",!1),I(this,"setModalTitle",e=>this.safeSetState({modalTitle:e})),I(this,"updateDescription",e=>{this.safeSetState({pinDescription:e})}),I(this,"close",()=>{const{onClose:e,boardPickerStopwatch:t}=this.props;e&&e(),t&&t.abort("boardPickerClose"),Object(x.b)(2502,{component:5,element:610})}),I(this,"safeSetState",(e,t)=>{this.unmounted?t&&t():this.setState(e,t)}),I(this,"getPinResource",(e,t,i)=>{var n,o;const{color:a,location:s,pin:c,method:d,guid:h,additionalCreateFields:u,advertiser_id:b,previousHistory:p}=this.props;let m;c.id&&(m=Object(r.a)(c,s,p)||(c.tracking_params||"")+"~0");const j=c.id?"RepinResource":"PinResource",g=!c.id&&c.image_url?Object(y.b)(c.image_url,c.link):(null===(n=c.images)||void 0===n||null===(o=n.orig)||void 0===o?void 0:o.url)||"",f={...u,board_id:t||"",color:a||"",clientTrackingParams:m,description:this.state.pinDescription,guid:h||"",link:c.link,image_base64:c.image_base64,image_url:g,is_buyable_pin:!1,is_removable:c.promoted_is_removable,media_upload_id:c.media_upload_id,method:d||"",pin_id:c.id||"",section:i,title:c.title||"",...b?{advertiser_id:b}:{}};if(!e){const{facebook:e,twitter:t}=this.state.sharing;f.share_facebook=e,f.share_twitter=t}return l.a.create(j,f)}),I(this,"triggerPubSubs",e=>{d.a.instance.publish("currentUser","pinCreated",e),d.a.instance.publish(e.board.id,"pinCreated",{pin:e})}),I(this,"makeCancelablePromise",e=>{let t=!1;return{promise:new Promise((i,n)=>{e.then(e=>t?n({isCanceled:!0}):i(e)),e.catch(e=>n(t?{isCanceled:!0}:e))}),cancel(){t=!0}}}),I(this,"handleLogToastClick",()=>{Object(x.b)(101,{component:20,view:52})}),I(this,"showSuggestedBoardToast",(e,t,i,o)=>{const{toastManagerContext:a,shouldShowToast:s}=this.props;if(s&&e){const{name:t,url:i,image_thumbnail_url:o}=e;a.showOneToast(({onHide:e})=>Object(T.jsx)(u.a,{duration:v.a,onHide:e,text:Object(T.jsxs)(n.Fragment,{children:[Object(T.jsx)(f.ab,{children:c.a._("You might also like","Post repin suggested board","Post repin suggested board")}),Object(T.jsx)(f.ab,{weight:"bold",children:t})]}),href:i,imageUrl:o,onClick:this.handleLogToastClick}))}}),I(this,"showBoardSavedToast",(e,t)=>{const{toastManagerContext:i}=this.props;i.showToast(({onHide:i})=>{var n,o;return Object(T.jsx)(u.a,{duration:v.a,onHide:i,text:Object(y.a)(e.name,t),href:t?`${null!==(n=e.url)&&void 0!==n?n:""}${t.slug}`:e.url,imageUrl:null!==(o=e.image_cover_url)&&void 0!==o?o:"",onClick:this.handleLogToastClick})})}),I(this,"dismissModal",e=>{const{resolve:t,newPin:i}=this.state;t&&t(i)}),I(this,"fetchBoardRecommendation",e=>l.a.create("RelatedBoardForPinRandomFeedResource",{pin:e.id,page_size:1}).callGet({showError:!1}).then(e=>Promise.resolve(e.resource_response.error?null:e.resource_response.data[0]))),I(this,"handleBoardSaveSuccess",(e,t,i,n)=>{var o,a;const{action:r,dispatch:d,hideSuccessAnimation:l,homeTakeoverExperience:h,pin:u,setCompletionPromise:p,shouldShowToast:f,viewerUserId:y}=this.props;d(Object(m.d)());const v=e.resource_response.data,_=this.makeCancelablePromise(new Promise((e,o)=>{this.triggerPubSubs(v);const a=this.state.pinDescription.match(B)||[];a.length>0&&Object(x.b)(2,{element:10273,hashtags:JSON.stringify(a),objectId:this.props.pin.id});const s=l?()=>{}:()=>{f&&this.showBoardSavedToast(t,i),this.safeSetState({displaySuccessAnimation:!0,modalTitle:c.a._("Board created","Modal title after creating a new board","Modal title after creating a new board"),newPin:v,resolve:e})};"repin"===r?(this.fetchBoardRecommendation(v).then(e=>{this.showSuggestedBoardToast(e,v,i,n)}),n?s():e(v)):("create"===r&&h&&500840===h.experience_id&&(d({type:"PIN_CREATED_VIA_CREATOR_CHECKLIST",payload:{pin_created_via_creator_checklist:!0}}),Object(x.b)(7510,{component:13233})),n?s():e(v))}));if(n||d(Object(g.d)(u.id)),p(_),d(Object(w.d)(t)),d(Object(b.d)({boardId:t.id,sectionId:i&&i.id,increment:1})),y&&(d(Object(O.c)({userId:y,increment:1})),d(Object(m.d)())),i||!t.image_cover_url){const{image_url:e,images:i}=u;t.image_cover_url=e||i&&i["236x"]&&i["236x"].url||"",d(Object(w.e)({},t))}i&&d(Object(s.a)(i.id)),d(Object(j.a)(u.id,t.id,null!==(o=t.name)&&void 0!==o?o:"",null!==(a=t.url)&&void 0!==a?a:"",v.id))}),I(this,"handleSaveToBoard",(e,t,i)=>{const{boardPickerStopwatch:n,onToggleModal:o,shouldShowToast:s}=this.props;n&&n.abort("boardPickerSubmit"),s&&!i&&(this.close(),this.showBoardSavedToast(e,t));const r="secret"===(e.privacy||""),c={board:t?t.id:e.id,state:v.b.LOADING};this.safeSetState({boardSavedTo:c},()=>{this.getPinResource(r,e.id,(t||{}).id).callCreate({showError:!1}).then(n=>{this.safeSetState({boardSavedTo:Object.assign(c,{state:v.b.SUCCESS})},()=>this.handleBoardSaveSuccess(n,e,t,i)),o&&!i&&o(!1)}).catch(e=>{this.unmounted||this.safeSetState({boardSavedTo:null}),a.a.showError(e.message_detail||e.message);const t=this.makeCancelablePromise(Promise.reject(e));this.props.setCompletionPromise(t),o&&o(!1)})})}),I(this,"handleSocialConnectSet",(e,t)=>{const i=Object.assign({},this.state.sharing);e===h.a.FACEBOOK?i.facebook=t:e===h.a.TWITTER&&(i.twitter=t),this.safeSetState({sharing:i})}),I(this,"handleNewBoardAnimationCompletion",()=>{const{dispatch:e,pin:t}=this.props;e(Object(g.d)(t.id))})}getModalTitle(e,t){return e?t?c.a._("Create section","modal title for create section pane","modal title for create section pane"):c.a._("Create board","Repin title for making a new board","Repin title for making a new board"):t?c.a._("Choose section","modal title for choose section","modal title for choose section"):c.a._("Choose board","Repin title for choosing a board","Repin title for choosing a board")}componentDidUpdate(e){const{boardWithSection:t,showCreate:i,pin:n,description:o}=this.props,a={};n===e.pin&&o===e.description||(a.pinDescription=n.description||o||""),i===e.showCreate&&t===e.boardWithSection||(a.modalTitle=this.getModalTitle(i,t)),Object.keys(a).length>0&&this.safeSetState(a)}componentWillUnmount(){this.unmounted=!0}render(){const{close:e,dismissModal:t,handleNewBoardAnimationCompletion:i,handleSaveToBoard:n,handleSocialConnectSet:o,setModalTitle:a,updateDescription:s}=this,{boardSavedTo:r,displaySuccessAnimation:c,modalTitle:d,newPin:l}=this.state,{color:h,pin:u}=this.props;return this.props.children({boardSavedTo:r,color:h,dismissModal:t,displaySuccessAnimation:c,handleAbort:e,handleNewBoardAnimationCompletion:i,handleSaveToBoard:n,handleSocialConnectSet:o,modalTitle:d,newPin:l,pin:u,setModalTitle:a,updateDescription:s})}}const E=Object(p.compose)(Object(o.connect)(e=>{const{advertiser:t,viewer:i,history:n}=e,o=i.isAuth&&t&&t.owner_user_id!==i.id?t.id:null,a=e.experiences.eligibleExperiences[11],s=e.experiences.eligibleExperiences[33];return{homeTakeoverExperience:a,previousHistory:n.previous,repinTakeoverExperience:s,...o?{advertiser_id:o}:{},...i.isAuth?{viewerUserId:i.id}:{}}}),S.c,C.l)((function(e){const t=Object(_.c)();return Object(T.jsx)(R,{...e,boardPickerStopwatch:t})}))},mvLR:function(e,t,i){function n(e){let t=!1;return{promise:new Promise((i,n)=>{e.then(e=>t?n({isCanceled:!0}):i(e),e=>n(t?{isCanceled:!0}:e))}),cancel(){t=!0}}}i.d(t,"a",(function(){return n}))},oN2T:function(e,t,i){i.d(t,"c",(function(){return m})),i.d(t,"b",(function(){return j})),i.d(t,"i",(function(){return g})),i.d(t,"g",(function(){return f})),i.d(t,"e",(function(){return x})),i.d(t,"m",(function(){return O})),i.d(t,"h",(function(){return v})),i.d(t,"d",(function(){return _})),i.d(t,"a",(function(){return S})),i.d(t,"l",(function(){return w})),i.d(t,"j",(function(){return C})),i.d(t,"k",(function(){return T})),i.d(t,"f",(function(){return I}));var n=i("4dcN"),o=i("Pqnw"),a=i("7w6Q"),s=i("eOdZ"),r=i("nrog"),c=i("KFEb"),d=i("5FNA"),l=i("NjDU"),h=i("Wer7");const u="board_create",b="board_delete",p="board_edit";function m(e,t){return Object(h.a)("BoardResource",{board_id:e,field_set_key:t})}function j(e={},t,i){return{type:"BOARD_CREATE_COMPLETE",payload:{options:e,board:t},error:i}}function g(){return(e,t)=>{const{viewer:i}=t();i.isAuth&&Object(d.b)(i.username).forEach(t=>{e(t)})}}function f(e,t){const i={...e};return o=>(o({type:"BOARD_CREATE",payload:{board:e}}),s.a.create("BoardResource",i).callCreate().then(e=>{n.a.trackEvent(u,"success");const a=e.resource_response.data;return a&&(o(g()),null!=t&&t.isFBC||o(j(i,a)),o(Object(r.a)(a.owner.id))),a}).catch(e=>{throw n.a.trackEvent(u,"error"),e}))}function x(e={},t,i){return{type:"BOARD_UPDATE_COMPLETE",payload:{options:e,board:t},error:i}}function O(e){return t=>{const i=void 0===e.collaborator_requests_enabled||null===e.collaborator_requests_enabled?{}:{collaborator_requests_enabled:e.collaborator_requests_enabled},o={board_id:e.id,name:e.name,description:e.description,category:e.category,collaborator_permissions_setting:e.collaborator_permissions_setting,privacy:e.privacy,collab_board_email:e.collab_board_email,collaborator_invites_enabled:e.collaborator_invites_enabled,allow_homefeed_recommendations:e.allow_homefeed_recommendations,...i};return t({type:"BOARD_UPDATE",payload:{boardUpdateOptions:o}}),s.a.create("BoardResource",o).callUpdate().then(i=>{n.a.trackEvent(p,"success");const a=i&&i.resource_response&&i.resource_response.data||e;t(x(o,a))}).catch(e=>{throw n.a.trackEvent(p,"error"),e})}}function y(e,t){return{type:"BOARD_DELETE_COMPLETE",payload:{boardId:e},error:t}}function v(e){return(t,i)=>{var o;const a=i().boards.content[e],{pin_count:r}=a,{id:c=""}=null!==(o=a.owner)&&void 0!==o?o:{};return t({type:"BOARD_DELETE",payload:{boardId:e}}),s.a.create("BoardResource",{board_id:e}).callDelete().then(()=>{n.a.trackEvent(b,"error"),t(y(e)),t(Object(l.c)({userId:c,increment:"number"==typeof r?-r:0}))}).catch(e=>{throw n.a.trackEvent(b,"error"),e})}}function _(e){return{type:"BOARD_PIN_TO",payload:{board:e}}}function S(e){return t=>(t(function(e){return{type:"BOARD_ARCHIVED",payload:{boardId:e}}}(e)),s.a.create("BoardArchiveResource",{boardId:e}).callUpdate())}function w(e){return t=>(t(function(e){return{type:"BOARD_UNARCHIVED",payload:{boardId:e}}}(e)),s.a.create("BoardArchiveResource",{boardId:e}).callDelete())}function C(e,t){return i=>s.a.create("BoardsMergeResource",{source_board_id:e,target_board_id:t}).callUpdate().then(()=>Promise.all([i(y(e)),i(m(t,"pin_count")),i(Object(o.a)(c.a.BOARD_SECTIONS,t))]))}function T(e,t){return i=>s.a.create("SocialSearchCampaignResource",{boardId:e}).callGet().then(e=>{if(!e||!e.resource_response){return i({type:"SET_SOCIAL_SEASONAL_BOARD",payload:{isSocialSeasonalBoard:!1,socialHeaderBgImage:"",socialHeaderBgColor:"",textIconColor:""}})}const n=e.resource_response.data||{},o=(n.model||{}).custom_properties||{},{campaign_id:s="unknown"}=o,r=n.display_data||{},c={isSocialSeasonalBoard:!!n.display_data,socialHeaderBgImage:r.header_image,socialHeaderBgColor:r.header_background_color,textIconColor:r.text_icon_color};return a.a.increment(`web.seasonal_board.${s}.${t}.land`),i({type:"SET_SOCIAL_SEASONAL_BOARD",payload:c})})}function I(){return e=>e({type:"SET_SOCIAL_SEASONAL_BOARD",payload:{isSocialSeasonalBoard:!1,socialHeaderBgImage:"",socialHeaderBgColor:"",textIconColor:""}})}},qyR9:function(e,t,i){i.d(t,"a",(function(){return g}));var n=i("q1tI"),o=i("jdx6"),a=i("gONw"),s=i("Ye/N"),r=i("gdcG"),c=i("n6mq"),d=i("nKUr");var l=Object(r.a)((function(e){const{buttonLabel:t,isHovering:i,isRowItem:n,hasHoverState:o,hoverHandlers:a,name:r,onClick:l}=e,h=r||t||s.a._("Create board");return Object(d.jsx)(c.Z,{onMouseEnter:a.onMouseOver,onMouseLeave:a.onMouseLeave,onTap:l,children:Object(d.jsxs)(c.f,{alignItems:"center",color:o&&i?"lightGray":"white",display:"flex",flex:n?"shrink":"none",height:64,width:"100%",children:[Object(d.jsx)(c.f,{marginStart:6,marginEnd:3,"data-test-id":"createBoardButton",children:Object(d.jsx)(c.v,{accessibilityLabel:s.a._("Add a board"),size:"32",icon:"add-circle",color:"red"})}),r?Object(d.jsx)(c.f,{margin:1,children:Object(d.jsxs)(c.ab,{inline:!0,overflow:"normal",children:[" ",s.a._("Create: ")," "]})}):null,Object(d.jsxs)(c.ab,{align:"center",inline:!0,truncate:!0,weight:"bold",children:[" ",h," "]})]})})})),h=i("9QW3"),u=i("NdQN"),b=i("IBrh"),p=i("seP0");function m(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class j extends n.Component{constructor(...e){super(...e),m(this,"state",{searchQuery:""}),m(this,"handleSelectItem",e=>{const{onCreate:t,onSelected:i}=this.props;if(!e&&t){const{searchQuery:e}=this.state;t(e)}else e&&i(e);(t||e)&&this.setState({searchQuery:""})}),m(this,"handleSearchQueryInput",e=>{this.setState({searchQuery:e})}),m(this,"renderSectionHeader",(e,t)=>e.title?Object(d.jsxs)(c.f,{children:[t>0&&Object(d.jsx)(c.p,{}),Object(d.jsx)(c.f,{paddingX:3,paddingY:1,children:Object(d.jsx)(c.ab,{size:"md",children:e.title})})]}):null),m(this,"renderRow",({item:e,hovered:t,sectionProps:i={}})=>{const{boardSavedTo:n,isSelectMode:a,disabledRowId:s}=this.props,{searchQuery:r}=this.state,{inSectionSelection:c=!1}=i,l=n&&n.board===e.id?n&&n.state:null,h="board_section"===e.type;return Object(d.jsx)(o.a,{disabled:e.id===s&&c,isSection:h,isSelectMode:a,isWithinSectionPicker:c,item:e,saveState:l,searchQuery:r,selected:t})})}componentDidUpdate(e){if(!e.isLoaded&&this.props.isLoaded){const{boardPickerStopwatch:e,hasLoadError:t}=this.props;e&&(t?e.error():e.stop())}}render(){const{boardSavedTo:e,createButtonLabel:t,hasLowBoardCount:i,getSections:n,isLoaded:o,onCreate:r,pinId:p}=this.props;if(o){const{searchQuery:o}=this.state,s=n(o);return this.indexManager=new h.a(s.map(e=>e.items)),this.indexManager.setSelectItem(this.handleSelectItem),Object(d.jsxs)(c.f,{minHeight:0,flex:"grow",height:"100%",overflow:"auto",display:"flex",direction:"column",dangerouslySetInlineStyle:{__style:{zIndex:0}},children:[!i&&Object(d.jsxs)(c.f,{children:[Object(d.jsx)(c.f,{paddingX:3,marginBottom:4,marginTop:1,children:Object(d.jsx)(u.a,{disabled:!!e,indexManager:this.indexManager,onChange:this.handleSearchQueryInput,value:o})}),Object(d.jsx)(c.p,{})]}),Object(d.jsx)(b.a,{disabled:!!e,grow:!i&&!o,indexManager:this.indexManager,onSelectItem:this.handleSelectItem,renderItem:this.renderRow,renderSectionHeader:this.renderSectionHeader,sections:s}),Object(d.jsx)(c.p,{}),r&&Object(d.jsx)(l,{buttonLabel:t,hasHoverState:!0,name:o,onClick:()=>r(o)}),i&&r&&p&&Object(d.jsx)(a.a,{onBoardSelected:r,pinId:p})]})}return Object(d.jsx)(c.f,{paddingY:5,children:Object(d.jsx)(c.T,{accessibilityLabel:s.a._("loading section picker","accessibility label for the loading spinner the repin picker","accessibility label for the loading spinner the repin picker"),show:!0})})}}function g(e){const t=Object(p.c)();return Object(d.jsx)(j,{...e,boardPickerStopwatch:t})}},"v+PR":function(e,t,i){i.d(t,"a",(function(){return j}));var n=i("q1tI"),o=i("Ye/N"),a=i("w70y"),s=i("vvax"),r=i("n6mq"),c=i("nKUr");function d({pin:e}){const{data:t}=Object(a.a)({name:"PinSaveStatusResource",options:{id:e.id},allowStale:!1});return t&&t.pinned_to_board?Object(c.jsxs)(r.f,{children:[Object(c.jsx)(r.f,{color:"red","data-test-id":"already-pinned",display:"flex",padding:3,rounding:2,width:185,children:Object(c.jsx)(r.ab,{align:"center",color:"white",size:"md",weight:"bold",children:Object(s.b)(o.a._("Psst! You already saved this Pin to {{ board_name }} ","Toast for already having repinned pin","Toast for already having repinned pin"),{board_name:(t.pinned_to_board||{}).name}).join(" ")})}),Object(c.jsx)(r.f,{display:"flex",justifyContent:"center",marginTop:-3,children:Object(c.jsx)(r.v,{accessibilityLabel:"",color:"red",icon:"heart",size:26})})]}):null}var l=i("P6kd"),h=i("g/XF"),u=i("U4JR");function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const p=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*/,m=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*$/;class j extends n.Component{constructor(...e){super(...e),b(this,"state",{cursorIndex:-1,flyoutCursorIndex:-1,description:this.props.pin&&this.props.pin.description&&this.props.pin.description.trim()||"",editing:!1,hashtagQuery:"",isHashtagFlyoutOpen:!1,flyoutOpened:!1}),b(this,"onDescriptionChange",(e,t)=>{const i=new RegExp(p,"g");let n="";if(t<e.length){let o=i.exec(e),a=i.lastIndex<t;for(;o&&a;)o=i.exec(e),a=i.lastIndex<t;const s=!!o&&p.test(e.slice(o.index,t));a=!!o&&o.index<t,o&&s&&a&&(n=o[0])}else{const t=m.exec(e);n=t?t[0]:""}this.updateDescription(e);const o=p.test(n),a=this.state.isHashtagFlyoutOpen?this.state.flyoutCursorIndex:e.slice(0,t).lastIndexOf("#");this.setState({cursorIndex:t,flyoutCursorIndex:a,description:e,hashtagQuery:n,isHashtagFlyoutOpen:o,flyoutOpened:this.state.flyoutOpened||o})}),b(this,"onCursorChange",e=>{const{isHashtagFlyoutOpen:t,flyoutCursorIndex:i}=this.state;t&&e<i&&this.setState({isHashtagFlyoutOpen:!1})}),b(this,"updateDescription",e=>{this.props.updateDescription&&this.props.updateDescription(e)}),b(this,"handleDescriptionBlur",e=>{const t=e.target.value.trim(),{isHashtagFlyoutOpen:i}=this.state;this.updateDescription(t),this.setState({description:t,editing:i})}),b(this,"handleDescriptionEdit",()=>{this.setState({editing:!0})}),b(this,"handleHashtagAddition",e=>{const{pin:t}=this.props;Object(u.b)(101,{component:208,element:10249,hashtags:e,objectId:t.id});const i=this.state.flyoutCursorIndex,n=Number(i+this.state.hashtagQuery.length),o=this.state.description.slice(0,i)+e+" "+this.state.description.slice(n);this.updateDescription(o),this.setState({description:o,editing:!0,hashtagQuery:"",isHashtagFlyoutOpen:!1})}),b(this,"handleRefTextArea",e=>{this._textArea=e})}render(){const{color:e,isFirstPin:t,pin:i,pinImageRef:n}=this.props,{description:o,editing:a,flyoutOpened:s,hashtagQuery:u,isHashtagFlyoutOpen:b}=this.state,{images:p,link:m}=i,j=p&&p["236x"],g=j&&j.url||i.image_base64;return Object(c.jsxs)(r.f,{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",width:t?"50%":"",dangerouslySetInlineStyle:{__style:s&&a?{transform:"translateY(-75px)"}:{}},children:[Object(c.jsxs)(r.f,{display:"flex",direction:"column",alignItems:"center",children:[i&&i.id&&Object(c.jsx)(d,{pin:i}),Object(c.jsx)(r.f,{paddingY:t?9:0,width:240,children:Object(c.jsx)(r.f,{ref:n,maxHeight:s&&a?220:335,rounding:4,overflow:"hidden",children:g?Object(c.jsx)(r.x,{alt:o,src:g,naturalHeight:(null==j?void 0:j.height)||1,naturalWidth:(null==j?void 0:j.width)||1}):!!m&&Object(c.jsx)(h.a,{color:e||"",description:o,url:m})})})]}),this.anchor&&b?Object(c.jsx)(l.a,{addHashtag:this.handleHashtagAddition,anchor:this.anchor,editing:a,query:u}):null]})}}},xjIv:function(e,t,i){function n(e,t,i,n,o){return{type:"PIN_SAVE",payload:{pinId:e,boardId:t,title:i,url:n,localPinId:o}}}function o(e){return{type:"PIN_UNSAVE",payload:{pinId:e}}}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}))}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/305-2f74da598e5eed8677d2.mjs.map