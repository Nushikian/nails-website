(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[118],{"/mzO":function(e,t,i){i.d(t,"a",(function(){return a}));var n=i("Ye/N"),o=i("n6mq"),s=i("nKUr");function a({commentsDisabled:e,onCommentChange:t,onPhotoChange:i,photosDisabled:a,isManagedView:r,isNoTitle:d}){const l=r?6:d?0:3;return Object(s.jsxs)(o.f,{children:[!d&&Object(s.jsx)(o.p,{}),Object(s.jsxs)(o.f,{mdDisplay:"flex",justifyContent:"between",paddingX:r?0:4,paddingY:l,children:[!r&&!d&&Object(s.jsx)(o.f,{column:12,mdColumn:3,paddingY:2,children:Object(s.jsx)(o.ab,{size:"md",children:n.a._("Comment and Photo Permissions")})}),Object(s.jsxs)(o.f,{column:12,mdColumn:r?12:8,children:[Object(s.jsxs)(o.f,{paddingY:1,display:"flex",alignItems:"center",children:[Object(s.jsx)(o.V,{onChange:t,id:"CommentSwitch",switched:!e}),Object(s.jsx)(o.f,{paddingX:2,children:Object(s.jsx)(o.y,{htmlFor:"CommentSwitch",children:Object(s.jsx)(o.ab,{size:"md",children:n.a._("Allow people to comment","Label for toggling comments on a pin in pin edit form","Label for toggling comments on a pin in pin edit form")})})})]}),i&&Object(s.jsxs)(o.f,{paddingY:1,alignItems:"center",display:"flex",children:[Object(s.jsx)(o.V,{onChange:i,id:"PhotoSwitch",switched:!a}),Object(s.jsx)(o.f,{paddingX:2,children:Object(s.jsx)(o.y,{htmlFor:"PhotoSwitch",children:Object(s.jsx)(o.ab,{size:"md",children:n.a._("Allow people to upload photos","Label for toggling photos on a pin in pin edit form","Label for toggling photos on a pin in pin edit form")})})})]})]})]})]})}},"1RGD":function(e,t,i){i.d(t,"a",(function(){return d}));var n=i("q1tI"),o=i("Ye/N"),s=i("vvax"),a=i("n6mq"),r=i("nKUr");function d({header:e,onUpdate:t,value:i}){const[d,l]=Object(n.useState)(i?String(Math.floor(Number.parseInt(i,10)/60)):"0"),[c,h]=Object(n.useState)(i?String(Number.parseInt(i,10)%60):"0"),u=(e,i)=>{t(String(Number.parseInt(i,10)+60*Number.parseInt(e,10)))},p=[];for(let n=0;n<=9;n+=1)p.push({value:String(n),label:Object(s.b)(o.a.ngettext("{{ hours }} hour","{{ hours }} hours",n,"storyboard.detailsList.recipe","Option for number of hours a story pin recipe will take"),{hours:n}).join("")});const b=[];for(let n=0;n<60;n+=1)b.push({value:String(n),label:Object(s.b)(o.a.ngettext("{{ minutes }} minute","{{ minutes }} minutes",n,"storyboard.detailsList.recipe","Option for number of minutes a story pin recipe will take"),{minutes:n}).join("")});return Object(r.jsxs)(a.f,{width:"100%",display:"flex",alignItems:"end",children:[Object(r.jsx)(a.f,{width:"50%",marginEnd:2,children:Object(r.jsx)(a.R,{size:"lg",id:"hours",name:"hours",label:e,placeholder:o.a._("Hours","storyboard.detailsList.recipe","Placeholder caption for hours input in story pin recipe cooktime"),value:d,options:p,onChange:({value:e})=>{Number.isNaN(e)||(l(e),u(e,c))}})}),Object(r.jsx)(a.f,{width:"50%",marginStart:2,children:Object(r.jsx)(a.R,{size:"lg",id:"minutes",name:"minutes",placeholder:o.a._("Minutes","storyboard.detailsList.recipe","Placeholder caption for minutes input in story pin recipe cooktime"),value:c,options:b,onChange:({value:e})=>{Number.isNaN(e)||(h(e),u(d,e))}})})]})}},"2K7C":function(e,t,i){i.d(t,"a",(function(){return a}));var n=i("yweb"),o=i("n6mq"),s=i("nKUr");function a(){const e=Object(n.c)();return Object(s.jsx)(o.f,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(s.jsx)(o.T,{accessibilityLabel:e._("Loading editor","EditorWithMentionsFallback.loading","Message shown while waiting for the editor to load"),show:!0})})}},"5S2N":function(e,t,i){i.d(t,"c",(function(){return we})),i.d(t,"b",(function(){return Pe}));var n=i("q1tI"),o=i("/MKj"),s=i("9WJf"),a=i("BkRI"),r=i.n(a),d=i("/mzO"),l=i("JW66"),c=i("eOdZ"),h=i("5FNA"),u=i("Wer7");var p=i("Sihc"),b=i("Y+p1"),j=i.n(b),g=i("Ye/N"),f=i("TgLd"),m=i("GBVV"),x=i("4cpq"),y=i("M1Uz"),O=i("nGHF"),v=i("n6mq"),_=i("nKUr");function C(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class S extends n.PureComponent{constructor(...e){super(...e),C(this,"state",{deleting:!1}),C(this,"unmounted",!1),C(this,"handleConfirm",()=>{if(this.state.deleting)return;const{onDeletePin:e}=this.props;this.setState({deleting:!0}),e().then(()=>this.handleDeleteDidComplete()).catch(e=>this.handleDeleteDidComplete(e))}),C(this,"handleDeleteDidComplete",e=>{const{toastManagerContext:t}=this.props;this.unmounted||this.setState({deleting:!1}),e||t.showToast(({onHide:e})=>Object(_.jsx)(y.a,{onHide:e,text:g.a._("Pin deleted!","User deleted their pin","User deleted their pin")}))})}componentWillUnmount(){this.unmounted=!0}render(){const{onDismiss:e}=this.props,{deleting:t}=this.state;return Object(_.jsx)(f.b,{heading:g.a._("Are you sure?","Confirm the user wants to delete the pin","Confirm the user wants to delete the pin"),accessibilityModalLabel:g.a._("Are you sure you want to delete this pin?","Accessible label to confirm the user wants to delete the pin","Accessible label to confirm the user wants to delete the pin"),size:"sm",onDismiss:e,footer:Object(_.jsxs)(v.f,{display:"flex",justifyContent:"end",marginStart:-1,marginEnd:-1,children:[Object(_.jsx)(v.f,{paddingX:1,children:Object(_.jsx)(v.g,{onClick:e,text:g.a._("Cancel")})}),Object(_.jsx)(v.f,{paddingX:1,children:Object(_.jsx)(x.a,{id:"confirm-delete-pin",children:Object(_.jsx)(m.b,{color:"red",onClick:this.handleConfirm,text:g.a._("Delete Pin"),submitting:t})})})]}),children:Object(_.jsx)(v.f,{padding:4,children:Object(_.jsx)(v.ab,{children:g.a._("Once you delete a Pin, you can't undo it!")})})})}}const w=Object(O.c)(S);w.displayName="DeletePinConfirmation";var k=w;function P({canEdit:e,onAltTextChange:t,altText:i}){return Object(_.jsxs)(n.Fragment,{children:[Object(_.jsx)(v.p,{}),Object(_.jsxs)(v.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(_.jsx)(v.f,{column:12,mdColumn:3,paddingY:2,children:Object(_.jsx)(v.y,{htmlFor:"AltTextField",children:Object(_.jsx)(v.ab,{size:"md",children:g.a._("Alt text","EditPinModal.EditAltText","Label for editing alt text of pin")})})}),Object(_.jsx)(v.f,{column:12,mdColumn:8,children:e?Object(_.jsxs)(n.Fragment,{children:[Object(_.jsx)(v.f,{children:Object(_.jsx)(v.cb,{id:"AltTextField",onChange:({value:e})=>t({value:e.slice(0,500)}),size:"lg",value:i||""})}),Object(_.jsx)(v.f,{justifyContent:"center",children:Object(_.jsx)(v.y,{htmlFor:"AltTextField",children:Object(_.jsx)(v.f,{marginTop:1,children:Object(_.jsx)(v.ab,{size:"md",color:"gray",children:g.a._("This helps people using screen readers understand what your Pin is about.","EditPinModal.EditAltText","Label for editing alt text of pin")})})})})]}):Object(_.jsx)(v.f,{column:12,mdColumn:8,paddingY:2,children:Object(_.jsx)(v.ab,{size:"md",weight:"bold",children:i})})})]})]})}var M=i("V711"),E=i("wm0H"),I=i("QAzJ");function D({board:e={},canEdit:t,onBoardChange:i,onBoardCreate:n}){const{anyEnabled:o}=Object(I.d)("web_boardless_pins"),{showEnabledSaveBehavior:s}=Object(E.a)(),a="quick_saves"===e.layout&&(o||s);return Object(_.jsxs)(v.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(_.jsx)(v.f,{column:12,mdColumn:3,paddingY:2,children:Object(_.jsx)(v.y,{htmlFor:"BoardPicker",children:Object(_.jsx)(v.ab,{size:"md",children:g.a._("Board")})})}),t?Object(_.jsx)(v.f,{column:12,mdColumn:8,children:Object(_.jsx)(M.a,{board:e,id:"BoardPicker",isBoardlessPinsBoard:a,onBoardChosen:i,onBoardCreate:n})}):e.name&&Object(_.jsx)(v.f,{column:12,mdColumn:8,paddingY:2,children:Object(_.jsx)(v.ab,{size:"md",weight:"bold",children:e.name})})]})}var T=i("TSYQ"),B=i.n(T),L=i("JKZO"),N=i("Q7uW"),R=i("U4JR");function U(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class A extends n.Component{constructor(...e){super(...e),U(this,"state",{focused:!1}),U(this,"suggestionAnchorRef",Object(n.createRef)()),U(this,"setRef",e=>this.textAreaRef=e),U(this,"handleBlur",e=>{this.setState({focused:!1});const{onBlur:t}=this.props;t&&t(e)}),U(this,"handleFocus",e=>{this.setState({focused:!0});const{onFocus:t}=this.props;t&&t(e)}),U(this,"handleChange",({text:e,mentions:t})=>{this.props.onDescriptionChange({value:e,userMentionTags:t})})}render(){const{canAddUserMentionTags:e,canEdit:t,description:i,errorMessage:o,initialMentions:s,label:a,placeholder:r,onDescriptionChange:d}=this.props,{focused:l}=this.state;return Object(_.jsxs)(n.Fragment,{children:[Object(_.jsx)(v.p,{}),Object(_.jsxs)(v.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(_.jsx)(v.f,{column:12,mdColumn:3,paddingY:2,children:Object(_.jsx)(v.y,{htmlFor:"DescriptionField",children:Object(_.jsx)(v.ab,{size:"md",children:a})})}),t?Object(_.jsxs)(v.f,{column:12,mdColumn:8,children:[Object(_.jsx)(v.f,{children:e?Object(_.jsx)("div",{className:B()("DescriptionField",{DescriptionField__error:!!o,DescriptionField__focus:l}),id:"DescriptionField",ref:this.suggestionAnchorRef,role:"textbox",children:Object(_.jsx)(L.a,{initialMentions:s,initialText:i,onAddMention:()=>{Object(R.b)(8905,{element:116,tag_type:1})},onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onSearchMentionCancel:()=>{Object(R.b)(8908,{element:116,tag_type:1})},onSuggestionsPopoverOpen:()=>{Object(R.b)(8907,{element:116,tag_type:1})},maxSuggestions:4,placeholder:r})}):Object(_.jsx)(v.bb,{id:"DescriptionField",placeholder:r,value:i,onChange:({value:e})=>{d({value:e,userMentionTags:[]})},hasError:(o||"").length>0})}),!!o&&Object(_.jsx)(v.f,{justifyContent:"center",children:Object(_.jsx)(N.a,{errorMessage:o,htmlFor:"pin-edit-description"})})]}):Object(_.jsx)(v.f,{column:12,mdColumn:8,paddingY:2,children:Object(_.jsx)(v.ab,{size:"md",weight:"bold",children:i})})]})]})}}var F=A,Y=i("VJm5"),z=i("rSLd"),V=i("xOLo");function H({isCarousel:e,onMouseEnter:t,onMouseLeave:i,shouldShowCarouselSliders:n,onCarouselSlide:o,currentIndex:s,carouselData:a,pinId:r,description:d,image:l={}}){return Object(_.jsxs)(v.f,{paddingX:4,paddingY:3,justifyContent:"center",direction:"column",children:[e&&(()=>{const e=a&&a.carousel_slots&&a.carousel_slots.length||1;return e>=2&&Object(_.jsx)(v.f,{direction:"row",padding:2,children:Object(_.jsx)(v.y,{htmlFor:"CardsIndex",children:Object(_.jsxs)(v.ab,{size:"md",children:[s+1,"/",e]})})})})(),Object(_.jsx)(v.C,{width:236,children:Object(_.jsxs)(v.f,{onMouseEnter:t,onMouseLeave:i,children:[Object(_.jsxs)(v.C,{rounding:2,wash:!0,children:[e&&n&&Object(_.jsx)(v.f,{width:"100%",height:"100%",display:"inlineBlock",position:"absolute",dangerouslySetInlineStyle:{__style:{zIndex:10,background:"rgba(0, 0, 0, 0.3)"}},children:Object(_.jsx)(V.default,{handleCarouselSwipe:o,carouselIndex:s,carouselData:a,pinId:r,isEditMode:!0})}),e?Object(_.jsx)(Y.a,{carouselIndex:s,isCloseup:!1,carouselData:a,pinId:r,isEditMode:!0}):Object(_.jsx)(v.x,{alt:d,color:"#efefef",naturalHeight:l.height,src:l.url,naturalWidth:l.width})]}),e&&Object(_.jsx)(z.default,{carouselIndex:s,carouselData:a,pinId:r,handleCarouselSwipe:o,isEditMode:!0,variant:"legacy"})]})})]})}function Q({apiErrorMessage:e,shouldShowGenericUpdateError:t,onClickDeleteButton:i,disableDelete:n,onHide:o,shouldDisableSave:s,triggerBoardAndSectionCreate:a}){return Object(_.jsxs)(v.f,{display:"flex",justifyContent:"between",marginStart:-1,marginEnd:-1,children:[Object(_.jsx)(x.a,{id:"delete-pin-button",children:Object(_.jsx)(v.g,{text:g.a._("Delete","EditPinModal.EditPinFooter.Delete","delete pin"),onClick:i,disabled:n})}),t&&Object(_.jsx)(v.f,{display:"flex",marginStart:2,marginTop:2,justifyContent:"center",children:Object(_.jsx)(N.a,{errorMessage:e||g.a._("Sorry! There was an error editing your Pin.","EditPinModal.EditPinFooter.ErrorMessageToast","Toast for pin edit error"),htmlFor:"pin-edit-generic-error"})}),Object(_.jsxs)(v.f,{display:"flex",justifyContent:"between",marginStart:-2,marginEnd:-2,children:[Object(_.jsx)(v.f,{paddingX:2,children:Object(_.jsx)(v.g,{text:g.a._("Cancel","EditPinModal.EditPinFooter.Cancel","cancel changes"),onClick:o})}),Object(_.jsx)(v.f,{paddingX:2,"data-test-id":"edit-pin-save",children:Object(_.jsx)(v.g,{text:g.a._("Save","EditPinModal.EditPinFooter.Save","save changes"),color:"red",onClick:a,disabled:s})})]})]})}function W({pinNoteText:e,isCollaborative:t,onPinNoteChange:i}){return Object(_.jsxs)(n.Fragment,{children:[Object(_.jsx)(v.p,{}),Object(_.jsxs)(v.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(_.jsx)(v.f,{column:12,mdColumn:3,paddingY:2,children:Object(_.jsx)(v.y,{htmlFor:"PinNoteField",children:Object(_.jsx)(v.ab,{size:"md",children:t?g.a._("Note to group","editPinModal.editPinNote.groupTitle","Label for editing private note on group Pin"):g.a._("Note to self","editPinModal.editPinNote.title","Label for editing private note on Pin")})})}),Object(_.jsx)(v.f,{column:12,mdColumn:8,paddingY:2,children:Object(_.jsx)(v.bb,{errorMessage:e.length>=500?g.a._("Character limit reached","editPinModal.editPinNote.warningText","Text to inform user they have reached the length limit on Pin note"):void 0,id:"PinNoteField",onChange:i,placeholder:g.a._("Add a private note to remember your ideas about this Pin","editPinModal.editPinNote.placeholderText","Placeholder for editing private note"),value:e})})]})]})}var K=i("NXrh");function X({board:e,canEdit:t,currentSection:i,onSectionChange:n,onSectionCreate:o,sectionId:s,sectionName:a}){const r=null!=e&&e.id?K.b:K.a;return Object(_.jsxs)(v.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(_.jsx)(v.f,{column:12,mdColumn:3,paddingY:3,children:Object(_.jsx)(v.y,{htmlFor:"SectionPicker",children:Object(_.jsx)(v.ab,{size:"md",children:g.a._("Section","label for editing a Pin's board section","label for editing a Pin's board section")})})}),t&&e?Object(_.jsx)(v.f,{column:12,mdColumn:8,children:Object(_.jsx)(r,{board:e,onSectionChange:n,selectedSectionId:s,selectedSectionName:a,onSectionCreate:o})}):Object(_.jsx)(v.f,{column:12,mdColumn:8,paddingY:2,children:Object(_.jsx)(v.ab,{size:"md",weight:"bold",children:i&&!(e||{}).is_collaborative?i.title:g.a._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit")})})]})}var q=i("VBRM"),G=i("8Enz"),J=i("kT2/"),Z=i("6HHy"),$=i("1RGD");function ee({keyValueBlocks:e,listBlocks:t,onUpdateKeyValueBlock:i,onUpdateListBlocks:o,templateType:s}){return Object(_.jsxs)(v.f,{children:[1===s&&Object(_.jsxs)(n.Fragment,{children:[Object(_.jsxs)(v.f,{paddingY:2,children:[Object(_.jsx)(v.ab,{size:"md",children:g.a._("Cook time","editModal.editStoryPinModal.details.cookTime","Label for cook time detail")}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)($.a,{onUpdate:e=>i(0,e),value:e[0]||null})})]},"cooktime"),Object(_.jsxs)(v.f,{paddingY:2,children:[Object(_.jsx)(v.ab,{size:"md",children:g.a._("Servings","editModal.editStoryPinModal.details.servings","Label for serving size detail")}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)(Z.a,{showLabel:!1,onUpdate:e=>i(1,e),value:e[1]||null})})]},"servingSize")]}),2===s&&Object(_.jsxs)(v.f,{paddingY:2,children:[Object(_.jsx)(v.ab,{size:"md",children:g.a._("Difficulty","editModal.editStoryPinModal.details.difficulty","Label for difficulty level detail")}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)(G.a,{showLabel:!1,onUpdate:e=>i(2,e),value:e[2]||null})})]},"difficulty"),Object(_.jsxs)(v.f,{paddingY:2,children:[Object(_.jsx)(v.ab,{size:"md",children:(()=>{switch(s){case 1:return g.a._("Ingredients","editModal.editStoryPinModal.listHeading","Heading for an ingredients list");case 2:return g.a._("Supplies","editModal.editStoryPinModal.listHeading","Heading for a supplies list");default:return g.a._("What they'll need","editModal.editStoryPinModal.listHeading","Heading for a generic list")}})()}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)(J.a,{listBlocks:t,onUpdate:o})})]})]})}var te=i("ESls"),ie=i("Joxa");var ne=i("vvax"),oe=i("MNxV");var se=Object(o.connect)(()=>({}),e=>({completeResourceFetch:t=>e(Object(u.b)("PinResource",{field_set_key:"detailed",id:t.id},t)),invalidatePin:t=>e(Object(u.f)("PinResource",{field_set_key:"detailed",id:t}))}))((function({apiErrorMessage:e,board:t,completeResourceFetch:i,commentsDisabled:o,description:s,disableDelete:a,invalidatePin:r,isLoadingPin:l,isProcessing:h,onChangeBoard:u,onChangeComment:p,onChangeSection:b,onClickBoardCreate:j,onClickDeleteButton:m,onClickEditPages:x,onClickSectionCreate:y,onHide:O,pinResource:C,sectionId:S,sectionName:w,title:k,triggerBoardAndSectionCreate:P}){var E,D;const T=null!==(E=C.data)&&void 0!==E?E:{},B=T.story_pin_data,L=null!==(D=T.images&&T.images["474x"])&&void 0!==D?D:{},[R,U]=Object(n.useState)(!1),[A,F]=Object(n.useState)(null),[Y,z]=Object(n.useState)(!1),[V,H]=Object(n.useState)({}),[Q,W]=Object(n.useState)([]);Object(n.useEffect)(()=>{const e=(null==B?void 0:B.metadata.basics)||null;if(e){const t=Object(ie.b)(e);H(t.keyValueBlocks||{}),W(t.listBlocks||[])}},[B]),Object(n.useEffect)(()=>{e&&F(e)},[e]);const X=(e,t)=>{H({...V,[e]:t}),U(!0)},G=e=>{W(e),U(!0)},{anyEnabled:J}=Object(I.a)("web_story_pin_edit_deprecation"),{anyEnabled:Z}=Object(I.a)("web_sp2s"),$=T.created_at?new Date(T.created_at):null,se=$&&Object(q.a)($,14),ae=!J&&!!se&&new Date<se,re=Q.length>0||Object.keys(V).length>0,de=Z?Object(ne.b)(g.a._("Edit details and add, delete, or reorder pages up to {{ numDays }} days after your Idea Pin is published. Edit the board and engagement settings any time.","editModal.editStoryPinModal.editTimeInformation","Let the user know how the edit settings are limited"),{numDays:14}):Object(ne.b)(g.a._("Edit details and add, delete, or reorder pages up to {{ numDays }} days after your Story Pin is published. Edit the board and engagement settings any time.","editModal.editStoryPinModal.editTimeInformation","Let the user know how the edit settings are limited"),{numDays:14});return Object(_.jsx)(f.b,{accessibilityModalLabel:g.a._("Edit your previously saved pin","editModal.editStoryPinModal.accessibilityLabel","Accessible label for edit previously saved story pin modal"),footer:Object(_.jsxs)(v.f,{display:"flex",justifyContent:"between",children:[Object(_.jsx)(v.f,{"data-test-id":"delete-pin-button",children:Object(_.jsx)(v.g,{color:"white",disabled:a,onClick:m,size:"lg",text:g.a._("Delete","editModal.editStoryPinModal.deleteButton","Delete button for previously saved story pin")})}),!!A&&Object(_.jsx)(v.f,{display:"flex",justifyContent:"center",children:Object(_.jsx)(N.a,{errorMessage:A,htmlFor:"pin-edit-generic-error"})}),Object(_.jsxs)(v.f,{display:"flex",justifyContent:"between",marginEnd:-1,marginStart:-1,children:[Object(_.jsx)(v.f,{paddingX:1,children:Object(_.jsx)(v.g,{onClick:O,size:"lg",text:g.a._("Cancel","editModal.editStoryPinModal.cancelButton","Cancel button to not save edits to previously saved story pin")})}),Object(_.jsx)(v.f,{"data-test-id":"edit-pin-save",paddingX:1,children:Object(_.jsx)(v.g,{color:"red",onClick:()=>{if(R&&B){z(!0);const e=Object(ie.c)({keyValueBlocks:V,listBlocks:Q}),t=function(e){return{metadata:{basics:e.metadata.basics?Object(ie.a)(e.metadata.basics):void 0,diy_data:e.metadata.diy_data,pin_image_signature:e.metadata.pin_image_signature,pin_title:e.metadata.pin_title,recipe_data:e.metadata.recipe_data,template_type:e.metadata.template_type},pages:(t=e.pages,t.map(e=>{var t;const i=e.blocks.map(e=>{switch(e.type){case"story_pin_paragraph_block":return{block_style:e.block_style,style:e.style,text:e.text,type:0};case"story_pin_heading_block":return{block_style:e.block_style,level:e.level,style:e.style,text:e.text,type:1};case"story_pin_image_block":return{block_style:e.block_style,image_signature:e.image_signature,tracking_id:e.tracking_id,type:2};case"story_pin_video_block":return{block_style:e.block_style,tracking_id:e.tracking_id,type:3,video_signature:e.video_signature};default:return null}}).filter(Boolean);return i.length>0?{blocks:i,layout:e.layout,style:null!==(t=e.style)&&void 0!==t&&t.background_color?{background_color:e.style.background_color}:void 0}:null}).filter(Boolean))};var t}(B),n={...t,metadata:{...t.metadata,basics:e}},o={pin_id:T.id,story_pin:JSON.stringify(n)};c.a.create("StoryPinEditResource",o).callUpdate().then(e=>{const{resource_response:t}=e;r(T.id),i(t.data),P()}).catch(e=>{F(e.message),z(!1)})}else P()},size:"lg",text:g.a._("Done","editModal.editStoryPinModal.doneButton","Done button to save edits to previously saved story pin")})})]})]}),heading:g.a._("Edit Pin","editModal.editStoryPinModal.heading","Edit a previously saved story pin"),onDismiss:O,size:"md",children:l||!C.isLoaded||Y||h?Object(_.jsx)(v.f,{paddingX:12,paddingY:9,children:Object(_.jsx)(v.T,{accessibilityLabel:g.a._("Loading edit information","editPinModal.editStoryPinModal.spinner","Accessible label for the edit pin loading icon"),show:!0})}):Object(_.jsx)(v.f,{overflow:"hidden",children:Object(_.jsx)(v.f,{marginEnd:-4,marginStart:-4,children:Object(_.jsx)(te.a,{name:"web_story_pin_limit_edits",children:({anyEnabled:e})=>{var i,a;return Object(_.jsxs)(v.f,{display:"flex",minHeight:300,overflow:"hidden",paddingX:8,children:[Object(_.jsxs)(v.f,{alignItems:"center",direction:"column",display:"flex",flex:"shrink",paddingX:4,children:[Object(_.jsxs)(v.C,{wash:!0,rounding:4,width:120,children:[Object(_.jsx)(v.x,{alt:s,color:"#efefef",naturalHeight:L.height,naturalWidth:L.width,src:L.url}),Object(_.jsx)(v.f,{position:"absolute",left:!0,top:!0,padding:2,children:Object(_.jsxs)(v.f,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"center",opacity:.8,padding:2,rounding:"pill",children:[Object(_.jsx)(v.v,{accessibilityLabel:Z?g.a._("Idea Pin icon","editModal.editStoryPinModal.storyPinIndicator","Idea Pin icon indicator"):g.a._("Story Pin icon","editModal.editStoryPinModal.storyPinIndicator","Story Pin icon indicator"),color:"darkGray",icon:"story-pin",size:12}),Object(_.jsx)(v.f,{marginStart:1,children:Object(_.jsx)(v.ab,{size:"md",weight:"bold",children:null===(i=T.story_pin_data)||void 0===i?void 0:i.page_count})})]})})]}),ae||!e?Object(_.jsx)(v.f,{"data-test-id":"edit-pages-button",paddingY:2,children:Object(_.jsx)(v.g,{inline:!0,onClick:x,text:g.a._("Edit pages","editModal.editStoryPinModal.editPagesButton","Edit pages label for story pin creation entry point")})}):null]}),Object(_.jsx)(v.f,{direction:"column",display:"flex",flex:"grow",paddingX:4,children:Object(_.jsx)(v.f,{marginBottom:-2,marginTop:-2,children:Object(_.jsx)(v.f,{maxHeight:500,overflow:"auto",paddingX:1,children:Object(_.jsxs)(v.f,{maxWidth:504,children:[e&&se&&Object(_.jsx)(v.f,{paddingY:2,children:ae?Object(_.jsxs)(n.Fragment,{children:[Object(_.jsx)(v.ab,{size:"md",children:Object(ne.b)(g.a._("Edit until {{ editDate }}","editModal.editStoryPinModal.lastEditableDate","Let user know the last date this Pin can be edited on"),{editDate:Object(_.jsx)(oe.b,{dateFormatType:oe.a.NUMERIC,useUTC:!1,value:se},"noEditsTwoWeeksAfter-"+(null!==(a=T.created_at)&&void 0!==a?a:""))})}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)(v.ab,{color:"gray",size:"md",children:de})})]}):Object(_.jsxs)(v.f,{children:[Object(_.jsx)(v.ab,{size:"md",children:g.a._("Editing","editModal.editStoryPinModal.editLabel","Label header for informing users story pin is only editable for board selection")}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)(v.ab,{size:"md",color:"gray",children:g.a._("Only board selection and engagement settings can be changed!","editModal.editStoryPinModal.editLabel","Label header for informing users story pin is only editable for board selection")})})]})}),Object(_.jsxs)(v.f,{paddingY:2,children:[Object(_.jsx)(v.ab,{size:"md",children:g.a._("Title","editModal.editStoryPinModal.titleLabel","Label for form input where users will input the title of their pin")}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsxs)(v.f,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"between",padding:4,rounding:4,children:[Object(_.jsx)(v.ab,{color:"gray",truncate:!0,children:k||""}),Object(_.jsx)(v.v,{accessibilityLabel:g.a._("Lock","editModal.editStoryPinModal.lockIcon.accessibilityLabel","Label for the lock icon to show that editing a story pin title is locked"),color:"darkGray",icon:"lock"})]})})]}),Object(_.jsxs)(v.f,{paddingY:2,children:[Object(_.jsx)(v.ab,{size:"md",children:g.a._("Board","editModal.editStoryPinModal.boardLabel","Label for dropdown where users will choose their board")}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)(M.a,{board:t,id:"BoardPicker",isStoryPin:!0,onBoardChosen:u,onBoardCreate:j})})]}),Object(_.jsxs)(v.f,{paddingY:2,children:[Object(_.jsx)(v.ab,{size:"md",children:g.a._("Section","editModal.editStoryPinModal.sectionLabel","Label for dropdown where users will choose their section")}),Object(_.jsx)(v.f,{paddingY:2,children:(null==t?void 0:t.id)&&Object(_.jsx)(K.b,{isStoryPin:!0,board:t,onSectionChange:b,onSectionCreate:y,selectedSectionId:S,selectedSectionName:w})})]}),e&&re&&ae&&Object(_.jsx)(ee,{keyValueBlocks:V,listBlocks:Q,onUpdateKeyValueBlock:X,onUpdateListBlocks:G,templateType:null==B?void 0:B.metadata.template_type}),T.can_delete_did_it_and_comments&&Object(_.jsxs)(v.f,{paddingY:2,children:[Object(_.jsx)(v.ab,{size:"md",children:g.a._("Comments and photos permissions","editModal.editStoryPinModal.commentsAndPhotosPermissionsLabel","Label for dropdown where users can toggle off permissions for comments and photos")}),Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)(d.a,{isNoTitle:!0,commentsDisabled:o,onCommentChange:p})})]})]})})})})]})}})})})})}));function ae({canEdit:e,onTitleChange:t,title:i,errorMessage:o}){return Object(_.jsxs)(n.Fragment,{children:[Object(_.jsx)(v.p,{}),Object(_.jsxs)(v.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(_.jsx)(v.f,{column:12,mdColumn:3,paddingY:2,children:Object(_.jsx)(v.y,{htmlFor:"TitleField",children:Object(_.jsx)(v.ab,{size:"md",children:g.a._("Title","Label for editing title of pin","Label for editing title of pin")})})}),Object(_.jsx)(v.f,{column:12,mdColumn:8,children:e?Object(_.jsxs)(n.Fragment,{children:[Object(_.jsx)(v.f,{children:Object(_.jsx)(v.cb,{hasError:(o||"").length>0,id:"TitleField",onChange:t,size:"lg",value:i})}),!!o&&Object(_.jsx)(v.f,{justifyContent:"center",children:Object(_.jsx)(N.a,{errorMessage:o,htmlFor:"pin-edit-title"})})]}):Object(_.jsx)(v.f,{column:12,mdColumn:8,paddingY:2,children:Object(_.jsx)(v.ab,{size:"md",weight:"bold",children:i})})})]})]})}function re({onChangeWebsite:e,link:t,errorMessage:i}){return Object(_.jsxs)(n.Fragment,{children:[Object(_.jsx)(v.p,{}),Object(_.jsxs)(v.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(_.jsx)(v.f,{column:12,mdColumn:3,paddingY:2,children:Object(_.jsx)(v.y,{htmlFor:"WebsiteField",children:Object(_.jsx)(v.ab,{size:"md",children:g.a._("Website")})})}),Object(_.jsxs)(v.f,{column:12,mdColumn:8,children:[Object(_.jsx)(v.f,{children:Object(_.jsx)(v.cb,{hasError:(i||"").length>0,id:"WebsiteField",onChange:e,size:"lg",value:t})}),!!i&&Object(_.jsx)(v.f,{justifyContent:"center",children:Object(_.jsx)(N.a,{errorMessage:i,htmlFor:"pin-edit-website"})})]})]})]})}var de=i("MhBu"),le=i("x12c"),ce=i("Wrea"),he=i("sH+O"),ue=i("OSge"),pe=i("KFEb"),be=i("r8eU"),je=i("qVfT"),ge=i("NjDU"),fe=i("w70y"),me=i("eIuQ"),xe=i("pLLR"),ye=i("ANjH"),Oe=i("c50B"),ve=i("VqlB"),_e=i("EC67");function Ce(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Se(e){return Boolean(e&&e.trim().length)}function we(e,t){const i=Se(e),n=Se(t);return(i||n)&&e!==t}class ke extends n.Component{constructor(...e){var t,i,n,o,s,a,d,h,u,p,b,f,m,x,y,O,v,_;super(...e),Ce(this,"state",{altText:(null===(t=this.props.pinResource.data)||void 0===t?void 0:t.alt_text)||"",board:(null===(i=this.props.pinResource.data)||void 0===i?void 0:i.board)||null,commentsDisabled:(null===(n=this.props.pinResource.data)||void 0===n?void 0:n.comments_disabled)||(null===(o=this.props.pinResource.data)||void 0===o?void 0:o.did_it_disabled)||!1,description:(null===(s=this.props.pinResource.data)||void 0===s||null===(a=s.description)||void 0===a?void 0:a.trim())||"",apiErrorMessage:null,link:(null===(d=this.props.pinResource.data)||void 0===d?void 0:d.link)||"",pinNoteText:(null===(h=this.props.pinResource.data)||void 0===h||null===(u=h.pin_note)||void 0===u?void 0:u.text)||"",sectionId:(null===(p=this.props.pinResource.data)||void 0===p||null===(b=p.section)||void 0===b?void 0:b.id)||null,sectionName:(null===(f=this.props.pinResource.data)||void 0===f||null===(m=f.section)||void 0===m?void 0:m.title)||null,showDeleteConfirmation:!1,carousel_data:(null===(x=this.props.pinResource.data)||void 0===x?void 0:x.carousel_data)||null,title:(null===(y=this.props.pinResource.data)||void 0===y?void 0:y.title)||"",isLoadingPin:!Boolean(this.props.pinResource.isLoaded),isProcessing:!1,currentIndex:void 0!==this.props.carouselSlotCurrentIndex?this.props.carouselSlotCurrentIndex:(null===(O=this.props.pinResource.data)||void 0===O||null===(v=O.carousel_data)||void 0===v?void 0:v.index)||0,shouldApplyTextToAll:!1,shouldDisableSave:!1,shouldShowCarouselSliders:!1,shouldShowValidationTitleError:!1,shouldShowValidationDescriptionError:!1,shouldShowValidationLinkFormatError:!1,shouldShowGenericUpdateError:!1,shouldShowValidationUserMentionTagsError:!1,userMentionTags:(null===(_=this.props.pinResource.data)||void 0===_?void 0:_.user_mention_tags)||[]}),Ce(this,"onClickDeleteButton",()=>this.setState({showDeleteConfirmation:!0})),Ce(this,"onHideConfirmation",()=>this.setState({showDeleteConfirmation:!1})),Ce(this,"updateCarouselSlotIndex",()=>{const{carouselSlotCurrentIndex:e}=this.props;this.setState({currentIndex:void 0!==e?e:this.props.pinResource.data&&this.props.pinResource.data.carousel_data&&this.props.pinResource.data.carousel_data.index||0})}),Ce(this,"handleBoardChange",e=>{const{board:{id:t}}=this.state;e.id!==t&&this.setState({board:e,sectionId:null,sectionName:null})}),Ce(this,"createBoard",e=>{const{createBoard:t}=this.props,{board:i}=this.state;!i.id&&i.name&&e&&t(i.name,e).then(e=>{if(this._isMounted){const{sectionId:t,sectionName:i}=this.state;!t&&i?(this.setState({board:e}),this.createSection()):(this.handleBoardChange(e),this.handleSave())}})}),Ce(this,"handleBoardCreateClick",e=>{if(!e)return;const t={name:e,privacy:l.a.BoardPrivacy.PUBLIC,access:"write"};this.setState({board:t,sectionId:null,sectionName:null})}),Ce(this,"createSection",()=>{const{board:e,sectionName:t}=this.state;if(!t)return;if(!e.id)return void this.createBoard();const i={boardId:e.id,name:t},{createSection:n}=this.props;n(i).then(e=>{this._isMounted&&(this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null}),this.handleSave())}).catch(()=>{this.setState({shouldShowGenericUpdateError:!0,apiErrorMessage:null})})}),Ce(this,"handleSectionCreateClick",e=>{if(0===e.length)return;const{board:t}=this.state;t&&this.setState({sectionId:null,sectionName:e})}),Ce(this,"handleSectionChange",e=>this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null,shouldShowGenericUpdateError:!1})),Ce(this,"handleDeletePin",()=>{const{advertiser_id:e,changeBoardPinCount:t,changeUserPinCount:i,onDelete:n,onHide:o,pinId:s,pinResource:{data:a},removeBoardlessPin:r,viewer:d}=this.props,l={...e?{advertiser_id:e}:{},id:s};return c.a.create("PinResource",l).callDelete().then(()=>{if(this._isMounted){if(!a)return;const{board:{id:e}={},pinner:{id:r}={},section:d}=a;t({boardId:e,sectionId:d&&d.id||void 0,increment:-1}),i({userId:r,increment:-1}),le.a.instance.publish(e,"pinDeleted",s),le.a.instance.publish(r,"pinDeleted"),le.a.instance.publish(s,"pinDeleted"),o(),n&&n()}d.id&&r(d.id,s)})}),Ce(this,"sanitizeCarouselData",e=>{let{carousel_data:t}=this.state;if(e&&(t=e),t){const{carousel_slots:e}=t;if(e){const t={carousel_slots:[]};return e.forEach(e=>{const i={};i.description=e.details||"",i.title=e.title||"",i.link=e.link||"",t.carousel_slots.push(i)}),t}}return null}),Ce(this,"triggerBoardAndSectionCreate",e=>()=>{const{board:t,sectionId:i,sectionName:n}=this.state;t&&!t.id&&t.name?this.createBoard(e):!i&&n?this.createSection():this.handleSave()}),Ce(this,"logPinEditEvent",(e,t,i,n,o)=>{const s={},{pinId:a,view:r,viewParameter:d}=this.props,{userMentionTags:l}=this.state;if(s.objectId=a,s.num_user_mention_tags=l.length,e&&(s.board_was_modified=!0),!e&&t&&(s.board_section_was_modified=!0),i){const{description:e}=this.state,{description:t}=o;s.original_pin_description=t,s.edited_pin_description=e}if(n){const{carousel_data:e}=this.state,{carousel_data:t}=o;s.original_carousel_data=JSON.stringify(this.sanitizeCarouselData(t)),s.edited_carousel_data=JSON.stringify(this.sanitizeCarouselData(e))}Object(R.b)(2,{component:208,view:r,viewParameter:d,...s})}),Ce(this,"handleSave",()=>{this.setState({apiErrorMessage:null,isProcessing:!0});const{advertiser_id:e,completeResourceFetch:t,invalidatePinResource:i,pinId:n,pinResource:{data:o},onHide:s,removeBoardlessPin:a,updatePinNote:r,viewer:d}=this.props;if(!o)return;const{alt_text:l,board:h,comments_disabled:u,did_it_disabled:p,title:b,description:g,link:f,pin_note:m,section:x,carousel_data:y}=o,O=null==m?void 0:m.text,{carousel_data:v,shouldShowValidationLinkFormatError:_}=this.state;let C;if(v){const e=this.sanitizeCarouselData();e&&(C=JSON.stringify(e))}const{altText:S,board:w,commentsDisabled:k,currentIndex:P,title:M,description:E,pinNoteText:I,sectionId:D,carousel_data:T,userMentionTags:B}=this.state,L=w||h,N=_?f:this.state.link,R={alt_text:S,board_id:null==L?void 0:L.id,board_section_id:D,carousel_data_json:C,description:E,disable_comments:k,disable_did_it:k,id:n,link:N,title:M,user_mention_tags:JSON.stringify(B),...e?{advertiser_id:e}:{}},U=x&&x.id||null,A=null==L?void 0:L.id,F=null==h?void 0:h.id,Y=we(l,S),z=F!==A,V=(Boolean(U)||Boolean(D))&&U!==D,H=we(b,M),Q=we(g,E),W=we(f,N),K=Boolean(T)&&Boolean(y)&&!j()(T,y),X=u!==k||p!==k,q=we(O,I);Y||z||V||H||Q||q||W||K||X?(q&&r(n,O,I),c.a.create("PinResource",R).callUpdate().then(({resource_response:e})=>{if(this._isMounted){const{changeBoardPinCount:l,onSubmit:c,pinId:h,pinMoved:u}=this.props;var n,r;if((z||V)&&A&&F)u({selectedPinIds:[h],source:{boardId:F,sectionId:U},target:{boardId:A,sectionId:D}}),l({boardId:A,sectionId:D||void 0,increment:1}),l({boardId:F,sectionId:U||void 0,increment:-1}),d.id&&"quick_saves"===(null===(n=o.board)||void 0===n?void 0:n.layout)&&a(d.id,h);if(c&&A&&null!=L&&L.url)c({boardId:A,title:null!==(r=L.name)&&void 0!==r?r:"",sectionId:D,url:L.url});s(),i(h);const{data:p}=e;p.carousel_data&&(p.carousel_data.index=P),t(p),this.logPinEditEvent(z,V,Q,K,o)}}).catch(()=>{const{shouldShowValidationTitleError:e,shouldShowValidationDescriptionError:t,shouldShowValidationLinkFormatError:i}=this.state;this.setState({isProcessing:!1,shouldShowGenericUpdateError:!e&&!t&&!i})})):(s(),i(n)),this.setState({isProcessing:!1})}),Ce(this,"handleTextChanges",(e,t)=>{const{carousel_data:i}=this.state;if(!i)return;const n=r()(i),{carousel_slots:o=[]}=n,{currentIndex:s,shouldApplyTextToAll:a,description:d,link:l,title:c}=this.state,h=this.valueIsValidForType(e,t);switch(a?o.forEach(i=>i[t]=e):o[s]&&(o[s][t]=e),t){case"details":const t=0===s?e:d;this.setState({description:t,carousel_data:n||null,shouldShowValidationDescriptionError:!h,shouldShowGenericUpdateError:!1});break;case"link":const i=0===s?e:l;this.setState({link:i,carousel_data:n||null,shouldShowValidationLinkFormatError:!h,shouldShowGenericUpdateError:!1});break;case"title":const o=0===s?e:c;this.setState({title:o,carousel_data:n||null,shouldShowValidationTitleError:!h,shouldShowGenericUpdateError:!1})}}),Ce(this,"handleDescriptionChange",({value:e,userMentionTags:t})=>{const i=this.valueIsValidForType(e,"description"),n=this.valueIsValidForType(t,"userMentionTags");t.length<this.state.userMentionTags.length&&Object(R.b)(8906,{element:116,tag_type:1}),this.setState({description:e,userMentionTags:t,shouldShowValidationDescriptionError:!i,shouldShowValidationUserMentionTagsError:!n,shouldShowGenericUpdateError:!1})}),Ce(this,"handleCarouselDetailsChange",({value:e})=>{this.handleTextChanges(e,"details")}),Ce(this,"handleTitleChange",({value:e})=>{const t=this.valueIsValidForType(e,"title");this.setState({title:e,shouldShowValidationTitleError:!t,shouldShowGenericUpdateError:!1})}),Ce(this,"handleCarouselTitleChange",({value:e})=>{this.handleTextChanges(e,"title")}),Ce(this,"handleAltTextChange",({value:e})=>{this.setState({altText:e})}),Ce(this,"valueIsValidForType",(e,t)=>{switch(t){case"details":case"description":return e.length<=500;case"link":return e.length>=0&&0===Object(Oe.r)([Object(Oe.q)({message:g.a._("Not a valid url.","Validation error for an improperly formated url","Validation error for an improperly formated url")})],e).length;case"title":return e.length<=100;case"userMentionTags":return e.length<=5;default:return!0}}),Ce(this,"handleWebsiteChange",({value:e})=>{const t=this.valueIsValidForType(e,"link");this.setState({link:e,shouldDisableSave:!t,shouldShowValidationLinkFormatError:!t,shouldShowGenericUpdateError:!1})}),Ce(this,"handleCarouselWebsiteChange",({value:e})=>{this.handleTextChanges(e,"link")}),Ce(this,"handleCommentChange",e=>this.setState({commentsDisabled:!e.value})),Ce(this,"handleShouldApplyToAll",e=>{if(e){const{currentIndex:t=0,carousel_data:i}=this.state;if(!i)return;const n=r()(i),{carousel_slots:o=[]}=n,{details:s,link:a,title:d}=o[t];o.forEach(e=>{e.details=s,e.title=d,e.link=a}),this.setState({carousel_data:n,shouldApplyTextToAll:e})}else this.setState({shouldApplyTextToAll:e})}),Ce(this,"handleCarouselSlider",e=>{const{carousel_data:t}=this.state,i=t&&t.carousel_slots&&t.carousel_slots.length||1;e>=0&&e<i&&this.setState({currentIndex:e})}),Ce(this,"handleClickStoryPinPages",()=>{const{pinResource:{data:e},history:t}=this.props;e&&t.push(`/story-pin-builder/${e.id}/edit`)}),Ce(this,"handleMouseEnter",()=>{this.setState({shouldShowCarouselSliders:!0})}),Ce(this,"handleMouseLeave",()=>{this.setState({shouldShowCarouselSliders:!1})})}componentDidMount(){this._isMounted=!0,this.updateCarouselSlotIndex()}componentDidUpdate(e){const{pinResource:{data:t,isLoaded:i},carouselSlotCurrentIndex:n}=this.props;var o;t&&i!==e.pinResource.isLoaded&&this.setState({altText:t.alt_text,board:t.board,commentsDisabled:t.comments_disabled||t.did_it_disabled,description:t.description&&t.description.trim(),isLoadingPin:!1,link:t.link,pinNoteText:(null===(o=t.pin_note)||void 0===o?void 0:o.text)||"",sectionId:(t.section||{}).id,sectionName:(t.section||{}).title,title:t.title,carousel_data:t.carousel_data,currentIndex:void 0!==n?n:t.carousel_data&&t.carousel_data.index||0,shouldApplyTextToAll:!1,userMentionTags:t.user_mention_tags||[]})}componentWillUnmount(){this._isMounted=!1}showErrorToast(e){this.props.toastManagerContext.showOneToast(({onHide:t})=>Object(_.jsx)(y.a,{color:"red",duration:5e3,onHide:t,text:e})),this.props.onHide()}getCurrentUserId(e){return e.isAuth?e.id:""}render(){const{disableDelete:e,onHide:t,pinResource:i,pinId:n,requestContext:o,viewer:a}=this.props,{altText:r,apiErrorMessage:l,board:c,commentsDisabled:h,description:u,link:p,pinNoteText:b,sectionId:j,sectionName:m,showDeleteConfirmation:x,title:y,isLoadingPin:O,isProcessing:C,carousel_data:S,shouldApplyTextToAll:w,currentIndex:M,shouldDisableSave:E,shouldShowCarouselSliders:I,shouldShowValidationTitleError:T,shouldShowValidationDescriptionError:B,shouldShowValidationLinkFormatError:L,shouldShowGenericUpdateError:N,shouldShowValidationUserMentionTagsError:R,userMentionTags:U}=this.state;if(x)return Object(_.jsx)(k,{onDeletePin:this.handleDeletePin,onDismiss:this.onHideConfirmation});const A=new be.b(o,"web_pin_edit_note_option").enabled(),Y=i.data||{},z=!!(S&&S.carousel_slots&&S.carousel_slots.length>1),V=S&&S.carousel_slots&&S.carousel_slots.length>0&&S.carousel_slots[M]||{},{details:K="",link:q="",title:G=""}=V,J=!!(Y&&Y.story_pin_data_id&&Y.story_pin_data),Z=Y&&(Y.access||[]).includes("write")||this.props.canEdit||!!c&&Object(s.a)({action:4,board:c}),$=e=>{const t=this.getCurrentUserId(e),i=this.props.canEdit&&this.props.advertiserOwnerUserId?this.props.advertiserOwnerUserId:t;return Z&&!Y.is_repin&&!J&&(z||!S)&&(Y.native_creator&&Y.native_creator.id===i||z&&Y.pinner&&Y.pinner.id===i||Y.link_domain&&Y.link_domain.official_user&&Y.link_domain.official_user.id===i||!!Y.domain&&Y.pinner&&Y.pinner.id===i&&Y.pinner.domain_url&&Y.pinner.domain_url.includes(Y.domain))},ee=Y&&Y.images&&Y.images["474x"]||{},te=new be.b(o,"web_story_pin_creator").enabledWithNoActivation(),ie=new be.b(o,"web_alt_text").enabledWithNoActivation(),ne=Y.story_pin_data&&Y.story_pin_data.metadata&&Y.story_pin_data.metadata.version?Object(he.b)(Y.story_pin_data.metadata.version,ue.c):null,oe=null!=ne&&ne>=0,de=!!Y.story_pin_data&&!!Y.story_pin_data.metadata&&!!Y.story_pin_data.metadata.is_editable&&Y.native_creator&&Y.native_creator.id===this.getCurrentUserId(a);if(J&&te&&oe&&de)return Object(_.jsx)(se,{apiErrorMessage:l,board:c,commentsDisabled:h,description:u,disableDelete:e,isLoadingPin:O,isProcessing:C,onChangeBoard:this.handleBoardChange,onChangeComment:this.handleCommentChange,onChangeSection:this.handleSectionChange,onClickBoardCreate:this.handleBoardCreateClick,onClickDeleteButton:this.onClickDeleteButton,onClickEditPages:this.handleClickStoryPinPages,onClickSectionCreate:this.handleSectionCreateClick,onHide:t,pinResource:i,sectionId:j,sectionName:m,title:y,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(a)});const le=$(a)?Object(_.jsx)(ae,{canEdit:Z,onTitleChange:z?this.handleCarouselTitleChange:this.handleTitleChange,title:z&&G?G:y,errorMessage:T?Object(me.b)(z):""}):null,ce=(Z||a.isAuth&&(Y.pinner||{}).id===a.id)&&$(a)?Object(_.jsx)(F,{canAddUserMentionTags:!z,canEdit:Z,description:(z?K:u)||"",errorMessage:B?Object(me.a)(z):R?Object(me.d)(z):"",initialMentions:U,label:g.a._("Description","Label for editing description","Label for editing description"),placeholder:g.a._("Tell us about this Pin...","Placeholder for editing description","Placeholder for editing description"),onDescriptionChange:z?this.handleCarouselDetailsChange:this.handleDescriptionChange}):null,pe=A?Object(_.jsx)(W,{isCollaborative:!(null==c||!c.is_collaborative),onPinNoteChange:({value:e})=>{this.setState({pinNoteText:e})},pinNoteText:b}):null,je=(e=>$(e)&&!(Y.aggregated_pin_data&&Y.aggregated_pin_data.is_shop_the_look))(a)?Object(_.jsx)(re,{link:z&&q?q:p,onChangeWebsite:z?this.handleCarouselWebsiteChange:this.handleWebsiteChange,errorMessage:L?Object(me.c)(z):""}):null,ge=z?Object(_.jsxs)(v.f,{display:"flex",justifyContent:"end",paddingX:4,paddingY:3,alignItems:"end",children:[Object(_.jsx)(v.f,{paddingY:2,children:Object(_.jsx)(v.y,{htmlFor:"applyTextToAll",children:Object(_.jsx)(v.ab,{children:g.a._("Apply text to all","Apply title, description, link to all cards","Apply title, description, link to all cards")})})}),Object(_.jsx)(v.f,{paddingX:2,paddingY:2,children:Object(_.jsx)(v.V,{onChange:e=>this.handleShouldApplyToAll(e.value),id:"applyTextToAll",switched:w})})]}):null,fe=$(a)&&ie?Object(_.jsx)(P,{canEdit:Z,onAltTextChange:this.handleAltTextChange,altText:r}):null,xe=Y.can_delete_did_it_and_comments?Object(_.jsx)(d.a,{commentsDisabled:h,onCommentChange:this.handleCommentChange}):null,ye=!!a.has_quicksave_board&&!!a.boardCount&&a.boardCount<2;return Object(_.jsx)(f.b,{heading:g.a._("Edit this Pin","EditPinModal.ModalHeading.EditThisPin","Edit a previously saved pin"),accessibilityModalLabel:g.a._("Edit your previously saved pin","EditPinModal.ModalHeading.AccessibleLabel","Accessible label for edit previously saved pin modal"),size:ye?"sm":"lg",onDismiss:t,footer:Object(_.jsx)(Q,{apiErrorMessage:l,shouldShowGenericUpdateError:N,onClickDeleteButton:this.onClickDeleteButton,disableDelete:e,onHide:t,shouldDisableSave:E,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(a)}),children:O||!i.isLoaded||C?Object(_.jsx)(v.f,{display:"flex",alignItems:"center",justifyContent:"center",children:Object(_.jsx)(v.T,{accessibilityLabel:g.a._("loading","EditPinModal.LoadingPin.Spinner","Accessible label for the edit pin loading icon"),show:!0})}):Object(_.jsxs)(v.f,{display:"flex",justifyContent:ye?"center":"between",minHeight:350,paddingX:4,children:[ye?null:Object(_.jsxs)(v.f,{column:12,mdColumn:9,children:[Object(_.jsx)(D,{board:c||Y.board,canEdit:Z,onBoardChange:this.handleBoardChange,onBoardCreate:this.handleBoardCreateClick}),Object(_.jsx)(X,{board:c||Y.board,canEdit:Z,onSectionCreate:this.handleSectionCreateClick,onSectionChange:this.handleSectionChange,sectionId:j,sectionName:m,currentSection:Y.section}),le,ce,je,ge,fe,pe,xe]}),Object(_.jsx)(H,{isCarousel:z,shouldShowCarouselSliders:I,onCarouselSlide:this.handleCarouselSlider,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,currentIndex:this.state.currentIndex,carouselData:this.state.carousel_data,pinId:n,description:u,image:ee})]})})}}const Pe=(e,t)=>({field_set_key:"detailed",id:e,preserve_component_state:t});t.a=Object(ye.compose)(O.c,Object(o.connect)((function(e){const{advertiser:t,viewer:i}=e;return i.isAuth&&t?{advertiser_id:t.id,...t.owner_user_id!==i.id?{advertiserOwnerUserId:t.owner_user_id}:{},viewer:i}:{viewer:i}}),e=>({changeBoardPinCount:t=>e(Object(ce.d)(t)),changeUserPinCount:t=>e(Object(ge.c)(t)),completeResourceFetch:t=>e(Object(u.b)("PinResource",Pe(t.id,!1),t)),createBoard:(t,i)=>e(function(e,t){const i={name:e,privacy:l.a.BoardPrivacy.PUBLIC};return e=>c.a.create("BoardResource",i).callCreate().then(i=>{const n=i.resource_response.data;return e(t.username&&Object(u.f)("BoardsResource",Object(h.a)(t.username,!1))),n})}(t,i)),createSection:t=>e(Object(p.a)(t)),invalidatePinResource:t=>e(Object(u.f)("PinResource",Pe(t,!0))),removeBoardlessPin:(t,i)=>e(Object(de.a)({feedId:t,feedType:pe.a.BOARDLESS_PINS,itemIds:[i],itemType:"pin"})),pinMoved:Object(ye.bindActionCreators)(ve.b,e),updatePinNote:(t,i,n)=>e(Object(je.a)(t,i,n))})))((function(e){const t=Object(fe.a)({name:"PinResource",options:Pe(e.pinId,!0)});return Object(_.jsx)(ke,{...e,history:Object(_e.h)(),pinResource:t,requestContext:Object(xe.d)()})}))},"6HHy":function(e,t,i){i.d(t,"a",(function(){return r}));var n=i("Ye/N"),o=i("vvax"),s=i("n6mq"),a=i("nKUr");function r({onUpdate:e,showLabel:t=!0,value:i}){const r=[];for(let s=1;s<=50;s+=1)r.push({value:String(s),label:Object(o.b)(n.a.ngettext("{{ servings }} serving","{{ servings }} servings",s,"storyboard.detailsList.field.servings","Option for number of servings a story pin recipe will provide"),{servings:s}).join("")});return Object(a.jsx)(s.f,{width:"100%",display:"flex",children:Object(a.jsx)(s.f,{width:"100%",position:"relative",children:Object(a.jsx)(s.R,{size:"lg",id:"servings",name:"servings",label:t?n.a._("Servings","storyboard.detailsList.field.servings","Header title for serving count entry for story pin recipe"):void 0,placeholder:n.a._("Pick a serving size","storyboard.detailsList.recipe","Placeholder caption for servings count input in story pin recipe"),value:i,options:r,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},"8Enz":function(e,t,i){i.d(t,"a",(function(){return a}));var n=i("Ye/N"),o=i("n6mq"),s=i("nKUr");function a({onUpdate:e,showLabel:t=!0,value:i}){const a=[{label:n.a._("Easy","storyboard.detailsList.field.difficulty","Easy difficulty rating for story pin"),value:String(1)},{label:n.a._("Intermediate","storyboard.detailsList.field.difficulty","Medium difficulty rating for story pin"),value:String(2)},{label:n.a._("Expert","storyboard.detailsList.field.difficulty","Hard difficulty rating for story pin"),value:String(3)},{label:n.a._("Not applicable","storyboard.detailsList.field.difficulty","Difficulty rating does not apply for story pin"),value:String(0)}];return Object(s.jsx)(o.f,{width:"100%",display:"flex",children:Object(s.jsx)(o.f,{width:"100%",children:Object(s.jsx)(o.R,{size:"lg",id:"servings",name:"servings",label:t?n.a._("Difficulty","storyboard.detailsList.field.difficulty","Header title for difficulty rating entry for story pin"):void 0,placeholder:n.a._("Pick a difficulty rating","storyboard.detailsList.field","Placeholder caption for difficulty rating input in story pin"),value:i,options:a,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},JKZO:function(e,t,i){i.d(t,"a",(function(){return d}));var n=i("2K7C"),o=i("MKeS"),s=i("nKUr"),a=i.n(s);const r=Object(o.a)({resolved:{},chunkName:()=>"EditorWithMentionsInternal",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!i.m[t]},importAsync:()=>i.e("EditorWithMentionsInternal").then(i.bind(null,"AO8i")),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return i(t)},resolve(){return"AO8i"}});function d(e){return Object(s.jsx)(r,{...e,fallback:Object(s.jsx)(n.a,{})})}},Joxa:function(e,t,i){i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return a}));const n=[0,2,1];function o(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map(e=>{const{heading:t,blocks:i}=e;return{heading:t,blocks:i.map(e=>({text:e.text,type:9})),type:7}}):[];return{key_value_blocks:i&&i.length>0?i.map(e=>({category_type:e.category_type,type:8,value:e.value})):[],list_blocks:n}}function s(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map(e=>{const{heading:t,blocks:i}=e;return{heading:t,items:i.map(e=>e.text)}}):[];return{keyValueBlocks:i&&i.length>0?i.reduce((e,t)=>{const{category_type:i,value:n}=t;return e[i]=n,e},{}):{},listBlocks:n}}function a(e){const{keyValueBlocks:t,listBlocks:i}=e;if(!t&&!i)return null;return{list_blocks:i?i.map(e=>{const{heading:t,items:i}=e;let n=[];return i&&(n=i.map(e=>({text:e,type:9}))),{blocks:n,heading:t,type:7}}):[],key_value_blocks:(t?Object.keys(t).map(e=>{const i=t[e],o=Number.parseInt(e,10),s=n.indexOf(o)>-1&&i===Number.parseInt(i,10).toString();return i&&s?{value:i,category_type:o,type:8}:null}):[]).filter(Boolean)}}},NXrh:function(e,t,i){i.d(t,"a",(function(){return m}));var n=i("q1tI"),o=i("/MKj"),s=i("Sihc"),a=i("Ye/N"),r=i("rrvb"),d=i("ANjH"),l=i("0BOE"),c=i("jdx6"),h=i("n6mq"),u=i("w70y"),p=i("nKUr");function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const j="NO_SECTION_VALUE";function g({section:e,hovered:t,searchQuery:i}){return Object(p.jsxs)(h.f,{children:[Object(p.jsx)(h.f,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:Object(p.jsx)(h.f,{flex:"grow",children:Object(p.jsx)(h.ab,{weight:"bold",children:Object(c.b)(i,e.title)})})}),e.id===j&&Object(p.jsx)(h.p,{})]})}class f extends n.Component{constructor(...e){super(...e),b(this,"state",{searchQuery:""}),b(this,"getPickerSections",()=>{const{searchQuery:e}=this.state,{sectionsResource:t,mergingFromSectionId:i}=this.props;let n=t&&t.data||[];return n=i?n.filter(e=>e.id!==i):[{id:j,title:a.a._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit")},...n],e.length>=2&&(n=Object(l.a)(n,e,"title")),[{items:n}]}),b(this,"createBtnDisabled",()=>{const{sectionsResource:e}=this.props,{searchQuery:t}=this.state;return!(!e||!e.data)&&e.data.some(e=>{var i;return(null===(i=e.title)||void 0===i?void 0:i.toLowerCase())===t.toLocaleLowerCase()})}),b(this,"handleSectionCreate",()=>{const{board:e,onSectionChange:t,sectionsResource:i,dispatch:n,onSectionCreate:o}=this.props,{searchQuery:a}=this.state;o?o(a):n&&e.id&&n(Object(s.a)({boardId:e.id,name:a})).then(e=>{i&&i.refreshData(),this.setState({searchQuery:""}),t(e)})}),b(this,"handleSectionSelected",e=>{const{onSectionChange:t}=this.props;e.id===j?(t(null),this.setState({searchQuery:""})):(t(e),this.setState({searchQuery:""}))}),b(this,"handleSearchQueryUpdate",e=>{this.setState({searchQuery:e})}),b(this,"renderRow",({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return Object(p.jsx)(g,{hovered:t,searchQuery:i,section:e})})}componentDidUpdate(e){const t=e.selectedSectionId,{selectedSectionId:i}=this.props;if(i!==t){const{sectionsResource:e}=this.props;e&&e.refreshData()}}render(){const{isStoryPin:e,sectionsResource:t,selectedSectionId:i,mergingFromSectionId:n,selectedSectionName:o}=this.props,{searchQuery:s}=this.state;let d=n?a.a._("Pick a section","default dropdown option for selecting a board section to merge to","default dropdown option for selecting a board section to merge to"):a.a._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit");if(i){let e;t&&t.data&&(e=t.data.find(e=>e.id===i)),d=e&&e.title||d}else o&&(d=o);return Object(p.jsxs)(h.f,{children:[Object(p.jsx)(h.T,{accessibilityLabel:a.a._("loading section picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!!t&&!t.isLoaded}),(!t||t&&t.isLoaded)&&Object(p.jsx)(r.a,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:d,isStoryPin:e,onCreate:n?null:this.handleSectionCreate,onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleSectionSelected,renderRow:this.renderRow,searchQuery:s,sections:this.getPickerSections()})]})}}const m=f;t.b=Object(d.compose)(Object(o.connect)(),Object(u.b)({name:"BoardSectionsRepinResource",key:"sectionsResource",options:e=>({board_id:e.board.id}),allowStale:!1}))(m)},Q7uW:function(e,t,i){i.d(t,"a",(function(){return s}));var n=i("n6mq"),o=i("nKUr");function s(e){const{htmlFor:t,errorMessage:i}=e;return Object(o.jsx)(n.y,{htmlFor:t,children:Object(o.jsx)(n.f,{marginTop:1,children:Object(o.jsx)(n.ab,{color:"red",size:"md",children:i})})})}},V711:function(e,t,i){var n=i("q1tI"),o=i("/MKj"),s=i("8cMa"),a=i("JW66"),r=i("Ye/N"),d=i("rrvb"),l=i("0BOE"),c=i("jdx6"),h=i("Wer7"),u=i("w70y"),p=i("n6mq"),b=i("ANjH"),j=i("oN2T"),g=i("nKUr");function f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m({board:e,hovered:t,searchQuery:i}){const n=e.privacy===a.a.BoardPrivacy.SECRET;return Object(g.jsxs)(p.f,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:[Object(g.jsx)(p.f,{flex:"grow",children:Object(g.jsx)(p.ab,{weight:"bold",children:Object(c.b)(i,e.name)})}),Object(g.jsxs)(p.f,{direction:"row",display:"flex",flex:"none",children:[n&&Object(g.jsx)(s.a,{type:"secret"}),e.is_collaborative&&Object(g.jsx)(s.a,{type:"group"})]})]})}class x extends n.Component{constructor(e){super(e),f(this,"getSections",()=>{const{searchQuery:e}=this.state,{boardResource:{data:{all_boards:t}}}=this.props;return e.length>=2?[{items:Object(l.a)(t,e)}]:[{items:t}]}),f(this,"createBtnDisabled",()=>{const{boardResource:{data:{all_boards:e}}}=this.props,{searchQuery:t}=this.state;return e.some(e=>{var i;return(null===(i=e.name)||void 0===i?void 0:i.toLowerCase())===t.toLowerCase()})}),f(this,"handleBoardCreate",e=>()=>{const{searchQuery:e}=this.state;if(!e)return;const{createBoard:t,invalidateBoardPickerBoardsResource:i,onBoardCreate:n}=this.props;i(),n?n(e):t({name:e,privacy:"public"}).then(e=>{const{onBoardChosen:t}=this.props;t(e)})}),f(this,"handleBoardSelected",e=>{this.props.onBoardChosen(e),this.setState({selectedBoard:e})}),f(this,"handleSearchQueryUpdate",e=>{this.setState({searchQuery:e})}),f(this,"renderRow",({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return Object(g.jsx)(m,{board:e,hovered:t,searchQuery:i})}),this.state={searchQuery:"",selectedBoard:e.board}}render(){const{boardResource:e,board:t,isBoardlessPinsBoard:i,isStoryPin:n,viewer:o}=this.props,{searchQuery:s,selectedBoard:a}=this.state;let l=r.a._("Select a board","Label for selecting a board in Edit Pin Modal","Label for selecting a board in Edit Pin Modal");return t?l=i?r.a._("Profile","BoardPickerFlyout.displayBoarName.boardlessPins","Title indicating the pin is saved to profile"):t.name:a&&(l=a.name),Object(g.jsxs)(p.f,{children:[Object(g.jsx)(p.T,{accessibilityLabel:r.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!e.isLoaded}),e.data&&Object(g.jsx)(d.a,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:l,isStoryPin:n,onCreate:this.handleBoardCreate(o),onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleBoardSelected,renderRow:this.renderRow,searchQuery:s,sections:this.getSections()})]})}}t.a=Object(b.compose)(Object(o.connect)((function(e){const{advertiser:t,viewer:i}=e,n=i.isAuth&&t&&t.owner_user_id!==i.id;return{advertiser_id:n?t.id:null,username:n?t.owner_user_id:null,viewer:i}}),(function(e){return{invalidateBoardPickerBoardsResource:()=>{e(Object(h.f)("BoardPickerBoardsResource",{field_set_key:"board_picker"}))},createBoard:t=>e(Object(j.g)(t))}})),Object(u.b)({name:"BoardPickerBoardsResource",key:"boardResource",options:e=>({pin_id:e.pinId,field_set_key:"board_picker",onlyFetchBoards:!0,username:e.username,...e.advertiser_id&&e.username?{advertiser_id:e.advertiser_id,filter:"protected",username:e.username}:{}}),allowStale:!1}))(x)},eIuQ:function(e,t,i){i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return s})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return r}));var n=i("Ye/N");function o(e){return e?n.a._("Title too long. Make sure all cards' titles have less than 100 characters","Title entered is too long while editing a carousel pin and/or one of its pins","Title entered is too long while editing a carousel pin and/or one of its pins"):n.a._("Title too long. Make sure title has less than 100 characters","Title entered is too long while editing a pin","Title entered is too long while editing a pin")}function s(e){return e?n.a._("Description too long. Make sure all cards' descriptions have less than 500 characters","Description entered is too long while editing a carousel pin and/or one of its pins","Description entered is too long while editing a carousel pin and/or one of its pins"):n.a._("Description too long. Make sure description has less than 500 characters","Description entered is too long while editing a pin","Description entered is too long while editing a pin")}function a(e){return n.a._("Too many mentions. Make sure you have at most 5.","editPinModal.errorMessages.userMentionOverLimit","Too many mentions used in the description")}function r(e){return e?n.a._("Need to provide a valid URL. Make sure all cards' links are valid","Invalid URL/link provided while editing a carousel pin and/or one of its pins","Invalid URL/link provided while editing a carousel pin and/or one of its pins"):n.a._("Need to provide a valid URL. Make sure the link is valid","Invalid URL/link provided while editing a pin","Invalid URL/link provided while editing a pin")}},"kT2/":function(e,t,i){var n=i("q1tI"),o=i("JW66"),s=i("Ye/N"),a=i("n6mq"),r=i("nKUr");const d=e=>{const t=e.split("\n");t.push("");const i=[];let n,o=[];return t.forEach(e=>{const t=e.indexOf("•");t>-1?(n||(n=""),o.push(e.substring(t+1).trim())):((n||o.length>0)&&i.push({heading:n,items:o}),n=e,o=[])}),i},l=e=>{let t="";return e.forEach((i,n)=>{const{heading:o,items:s}=i;o&&(t+=o),s&&s.length>0&&(t+="\n• "+s.join("\n• ")),n<e.length-1&&(t+="\n\n")}),t};t.a=function({header:e,helperText:t,listBlocks:i,onUpdate:c,placeholderListBlocks:h}){const u=l(h||[{heading:s.a._("What you'll need","storyboard.detailsList.placeholder","Placeholder text header for details list of story Pin"),items:[s.a._("Write a bullet list of tools, materials and anything else!","storyboard.detailsList.placeholder","Placeholder text instructions for details list of story Pin"),s.a._("Type it up or copy and paste.","storyboard.detailsList.placeholder","Placeholder text instructions for details list of story Pin")]}]),[p,b]=Object(n.useState)(i?l(i):"");return Object(r.jsx)(a.f,{children:Object(r.jsx)(a.bb,{id:"storyboard-details-list",helperText:t,label:e,onChange:({value:e})=>{b(e),c(d(e))},onBlur:()=>{""===p.trim()&&b("")},onKeyDown:({event:e,value:t})=>{const{keyCode:i,target:n,shiftKey:s}=e;if(n instanceof HTMLTextAreaElement){const{selectionStart:a,selectionEnd:r}=n;if(a===r){let r=0,l=0,h="";if(i===o.a.KeyCode.ENTER?"\n• "!==t.substring(a-3,a)||"\n"!==t.substring(a,a+1)&&a!==t.length?s||"\n"===t.substring(a-1,a)||(r=0,h="\n• "):(r=-3,h="\n"):i!==o.a.KeyCode.BACKSPACE&&i!==o.a.KeyCode.DELETE||("\n• "===t.substring(a-3,a)?r=-3:"\n•"===t.substring(a-2,a)?r=-2:"\n"===t.substring(a-1,a)&&"•"===t.substring(a,a+1)&&(r=-1,l=1)),0!==r||0!==l||""!==h){const i=t.substring(0,a+r)+h+t.substring(a+l);b(i);const o=a+r+h.length;setTimeout(()=>{n.selectionStart=o,n.selectionEnd=o},10),c(d(i)),e.preventDefault()}}}},placeholder:u,rows:7,value:p})})}},qVfT:function(e,t,i){i.d(t,"a",(function(){return o}));var n=i("eOdZ");function o(e,t,i){return async o=>{const s=n.a.create("ApiResource",{url:`/v3/pins/${e}/notes/`,data:{pin_note_content:i}});let a;a=i?t?await s.callUpdate():await s.callCreate():await s.callDelete();const{resource_response:r}=a;o(function(e,t){return{type:"PIN_NOTE_UPDATE",payload:{pinId:e,pinNote:t}}}(e,null==r?void 0:r.data))}}},rrvb:function(e,t,i){var n=i("q1tI"),o=i("Ye/N"),s=i("9QW3"),a=i("NdQN"),r=i("IBrh"),d=i("gdcG"),l=i("n6mq"),c=i("nKUr");function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class u extends n.Component{constructor(...e){super(...e),h(this,"state",{showFlyout:!1}),h(this,"setContainerRef",e=>{this.containerRef=e}),h(this,"handleCreate",()=>{this.hideFlyout();const{onCreate:e}=this.props;e&&e()}),h(this,"handleSelectItem",e=>{this.hideFlyout();const{onSelect:t,onCreate:i}=this.props;e?t(e):i&&i()}),h(this,"handleDropdownTouch",()=>{this.setState(e=>({showFlyout:!e.showFlyout}))}),h(this,"handleHideFlyout",e=>{this.containerRef&&e.target instanceof HTMLElement&&!this.containerRef.contains(e.target)&&this.hideFlyout()}),h(this,"hideFlyout",()=>{const{hoverHandlers:{onMouseLeave:e}}=this.props;e(),this.setState({showFlyout:!1})})}componentDidMount(){document.addEventListener("click",this.handleHideFlyout,{capture:!0})}componentWillUnmount(){document.removeEventListener("click",this.handleHideFlyout,{capture:!0})}render(){const{dropdownValue:e,fetchMore:t,hoverHandlers:{onMouseOver:i,onMouseLeave:n},isHovering:d,isStoryPin:h,onCreate:u,onSearchQueryUpdate:p,renderRow:b,searchQuery:j,sections:g,createBtnDisabled:f}=this.props,{showFlyout:m}=this.state;this.indexManager=new s.a(g.map(e=>e.items)),this.indexManager.setSelectItem(this.handleSelectItem);const x=!j.trim()||!!f;return Object(c.jsxs)("div",{ref:this.setContainerRef,style:{...h?{flex:"grow"}:{}},children:[Object(c.jsx)(l.Z,{fullWidth:!!h,onMouseEnter:i,onMouseLeave:n,onTap:this.handleDropdownTouch,rounding:2,children:Object(c.jsxs)(l.f,{alignItems:"center",color:d?"lightWash":"lightGray",direction:"row",display:"flex",flex:"grow",paddingX:4,paddingY:h?4:3,rounding:h?4:2,children:[Object(c.jsx)(l.f,{display:"flex",flex:"grow",children:Object(c.jsx)(l.ab,{weight:"bold",children:e})}),Object(c.jsx)(l.v,{accessibilityLabel:"",color:"darkGray",icon:"arrow-down",size:14})]})}),m&&Object(c.jsx)(l.f,{position:"relative",children:Object(c.jsxs)(l.f,{borderStyle:"sm",color:"white",dangerouslySetInlineStyle:{__style:{zIndex:1}},direction:"column",display:"flex",overflow:"hidden",position:"absolute",rounding:h?4:2,width:"100%",children:[Object(c.jsx)(l.f,{children:Object(c.jsxs)(l.f,{display:"flex",marginStart:-1,marginEnd:-1,padding:2,children:[Object(c.jsx)(l.f,{display:"flex",flex:"grow",paddingX:1,children:Object(c.jsx)(a.a,{hideIcon:!0,indexManager:this.indexManager,onChange:p,value:j})}),u&&Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(l.g,{disabled:x,inline:!0,onClick:this.handleCreate,text:o.a._("Create","board or section dropdown create button","board or section dropdown create button")})})]})}),Object(c.jsx)(r.a,{fetchMore:t,indexManager:this.indexManager,maxHeight:240,onSelectItem:this.handleSelectItem,renderItem:b,sections:g})]})})]})}}t.a=Object(d.a)(u)},xOLo:function(e,t,i){i.r(t),i.d(t,"CarouselSliders",(function(){return b}));var n=i("/MKj"),o=i("XSD5"),s=i("ZbwW"),a=i("Ye/N"),r=i("0nTG"),d=i("U4JR"),l=i("n6mq"),c=i("nKUr");const h={slider:{cursor:"pointer",height:"100%",position:"relative",width:"10%",zIndex:"105",pointerEvents:"auto"}},u=(e,t,i,n,o,s,a,l,c,h)=>{if(!h||!o){const{carousel_slots:h,id:u}=o;Object(d.b)(108,{...c,objectId:t,component:l,view:a,viewParameter:s,eventData:{pinCarouselSlotEventData:{carouselSlotId:(null==h?void 0:h[i])&&Number(h[i].id),carouselDataId:Number(u),carouselSlotIndex:i,toCarouselSlotIndex:n}},...Object(r.f)(e)||{}})}},p=(e,t,i,n,o,s)=>{s||void 0===n||(e.preventDefault(),e.stopPropagation(),n(t,i)),void 0!==o&&o(i)},b=({carouselIndex:e,carouselData:t,changeCarouselSlotIndex:i,handleCarouselSwipe:n,pin:o,pinId:s,contextLogData:r,viewParameter:d,viewType:b,componentType:j,isEditMode:g})=>{if(!t)return null;const{carousel_slots:f=[],index:m=0}=t,x=void 0!==e?e:m,y=Math.max(0,x-1),O=Math.min(f.length-1,x+1);return Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",position:"absolute",left:!0,right:!0,bottom:!0,top:!0,children:[Object(c.jsx)("div",{"data-test-id":"carousel-slider-left",role:"presentation",onClick:e=>{p(e,s,y,i,n,g),u(o,s,x,y,t,d,b,j,r,g)},onKeyUp:e=>{p(e,s,y,i,n,g),u(o,s,x,y,t,d,b,j,r,g)},style:h.slider,children:x>0&&Object(c.jsx)(l.f,{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",children:Object(c.jsx)(l.v,{color:"white",icon:"arrow-back",accessibilityLabel:a.a._("View Previous","Button to advance carousel to the previous image","Button to advance carousel to the previous image")})})}),Object(c.jsx)("div",{"data-test-id":"carousel-slider-right",role:"presentation",onClick:e=>{p(e,s,O,i,n,g),u(o,s,x,O,t,d,b,j,r,g)},onKeyUp:e=>{p(e,s,O,i,n,g),u(o,s,x,O,t,d,b,j,r,g)},style:h.slider,children:x<f.length-1&&Object(c.jsx)(l.f,{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",children:Object(c.jsx)(l.v,{color:"white",icon:"arrow-forward",accessibilityLabel:a.a._("View Next","Button to advance carousel to the next image","Button to advance carousel to the next image")})})})]})};t.default=Object(n.connect)(({pins:e},{carouselData:t,pinId:i})=>{const n=e[i];return{pin:n,carouselData:t||Object(s.a)(n)}},e=>({changeCarouselSlotIndex:(t,i)=>e(Object(o.a)(t,i))}))(b)}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/118-4f6ef2d680aa53b21734.mjs.map